import{o as $,K as _,j as e,Y as A,r as h,a4 as L,a8 as c,ax as q,p as C,C as E,a0 as n,a2 as p,a6 as g,ab as I,ac as v,aZ as N,ad as G,a_ as J,S as k,U as R,aw as T,I as z,J as O,V as B,ag as V,at as Y,a9 as K}from"./index-BrIZ1aRM.js";import{a as Q}from"./axios-B2-DI6Hg.js";import{L as W}from"./LinearProgress-DM9o_yrw.js";import{F as D}from"./index-CJagu-9E.js";import"./error-DW4k7GIP.js";var X=$("camera","IconCamera",[["path",{d:"M5 7h1a2 2 0 0 0 2 -2a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1a2 2 0 0 0 2 2h1a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-9a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M9 13a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-1"}]]);const M=_(e.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility"),U=_(e.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff"),H="/assets/overlay_4-DM8QFxIw.jpg",P=({label:a,info:o})=>{const i=A();return e.jsxs(c,{sx:{padding:1},children:[e.jsx(C,{variant:"subtitle2",color:i.palette.text.disabled,children:a}),e.jsx(c,{sx:{width:"auto",mt:.6,border:.8,borderColor:i.palette.divider,paddingY:1.2,paddingX:1.6,borderRadius:i.shape.borderRadius},children:e.jsx(C,{variant:"subtitle1",color:i.palette.text.primary,children:o})})]})},Z=({userInfo:a})=>{const o=A(),[i,d]=h.useState(""),[u,x]=h.useState(0),w=l=>{const s=l.target.files[0];if(s){const m=new FileReader;m.onload=()=>{d(m.result),y(s)},m.readAsDataURL(s)}},y=async l=>{const s=localStorage.getItem("token"),m=g.auth+g.updateProfileImage,r={Authorization:`Bearer ${s}`,"Content-Type":"multipart/form-data"},S=new FormData;S.append("profile_image",l),(await Q.post(m,S,{headers:r,onUploadProgress:t=>{const j=Math.round(t.loaded*100/t.total);x(j)}})).then(t=>t.json()).then(t=>{var j;t.success?(p.success(t.data.message),localStorage.setItem("profile-image",(j=t.data)==null?void 0:j.profile_image),d(t.data.profile_image)):p.error(t.data.message)}).catch(t=>{p.error(t.message)})},b=()=>{const l=localStorage.getItem("token"),s=g.auth+g.removeProfileImage,m={Authorization:`Bearer ${l}`,"Content-Type":"multipart/form-data"};fetch(s,{method:"POST",headers:m}).then(r=>r.json()).then(r=>{r.success?(d(null),localStorage.removeItem("profile-image")):p.error(r.data.message)}).catch(r=>{p.error(r.message)})};return h.useEffect(()=>(d(a==null?void 0:a.profile_image),()=>{}),[]),e.jsxs(L,{sx:{padding:3},children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(c,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:46,height:46,borderRadius:23,backgroundColor:o.palette.primary.light,marginRight:2},children:e.jsx(q,{stroke:1.8,size:"1.8rem"})}),e.jsx(C,{variant:"h4",color:o.palette.text.primary,children:"Basic Details"})]}),e.jsxs("form",{children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center"},children:[e.jsxs(c,{sx:{position:"relative",marginTop:3.6,marginBottom:1.6,border:1,height:100,width:100,borderRadius:60,overflow:"hidden",cursor:"pointer","&:hover .overlay":{opacity:1},borderColor:o.palette.grey[400],borderStyle:"dashed",textAlign:"center"},onClick:()=>document.getElementById("profileImageUpload").click(),children:[e.jsx("img",{src:i||H,alt:"Profile",height:"94%",width:"94%",style:{aspectRatio:1,objectFit:"cover",borderRadius:50,margin:3}}),e.jsxs(c,{className:"overlay",sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",bgcolor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,transition:"opacity 0.3s ease"},children:[e.jsx(X,{stroke:1.6,size:"1.4rem",color:"#fff"}),e.jsx(C,{sx:{ml:1,color:"#fff"},children:"Select"})]})]}),i&&e.jsx(E,{variant:"text",sx:{marginLeft:2,borderRadius:2},onClick:()=>b(),children:"Remove"})]}),u>0&&e.jsx(W,{value:u,sx:{marginBottom:2,marginLeft:1}}),e.jsx("input",{type:"file",id:"profileImageUpload",accept:"image/*",style:{display:"none"},onChange:w})]}),(a==null?void 0:a.name)&&e.jsx(P,{label:"Full name",info:a==null?void 0:a.name}),(a==null?void 0:a.email)&&e.jsx(P,{label:"Email",info:a==null?void 0:a.email}),(a==null?void 0:a.phone)&&e.jsx(P,{label:"Phone",info:a==null?void 0:a.phone}),e.jsxs(n,{container:!0,children:[e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(P,{label:"Unit",info:"Product development"})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(P,{label:"Position",info:"Senior software developer"})})]}),e.jsx(P,{label:"Start date",info:"July 17, 2024"})]})},ee=I().shape({oldPassword:v().max(255).required("Old password is required"),newPassword:v().max(255).required("New password is required"),confirmPassword:v().oneOf([N("newPassword"),null],"The passwords are not match").max(255).required("Please confirm new password")}),se=()=>{const a=A(),[o,i]=h.useState(!1),[d,u]=h.useState(!1),[x,w]=h.useState(!1),y=()=>{i(!o)},b=()=>{u(!d)},l=r=>{r.preventDefault()},s=G({initialValues:{oldPassword:"",newPassword:"",confirmPassword:""},validationSchema:ee,onSubmit:r=>{m(r)}}),m=r=>{w(!0);const S=localStorage.getItem("token"),F=g.auth+g.changePassword,t={Authorization:`Bearer ${S}`,accept:"application/json","Content-Type":"application/json"},j={current_password:r==null?void 0:r.oldPassword,new_password:r==null?void 0:r.newPassword,confirm_new_password:r==null?void 0:r.confirmPassword};fetch(F,{method:"POST",headers:t,body:JSON.stringify(j)}).then(f=>f.json()).then(f=>{f.success?(w(!1),p.success("Password changed successfully")):(w(!1),p.error(f.data.message))}).catch(f=>{p.error(f.message),w(!1)})};return e.jsxs(n,{container:!0,sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:1},children:[e.jsx(n,{item:!0,xs:12,md:12,children:e.jsxs(L,{sx:{padding:3,marginTop:2},children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(c,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:46,height:46,borderRadius:23,backgroundColor:a.palette.primary.light,marginRight:2,padding:1},children:e.jsx(J,{stroke:1.8,size:"1.6rem"})}),e.jsx(C,{variant:"h4",children:"Change Password"})]}),e.jsxs("form",{noValidate:!0,onSubmit:s.handleSubmit,children:[e.jsxs(k,{sx:{display:"flex",marginTop:5},error:!!(s.touched.oldPassword&&s.errors.oldPassword),children:[e.jsx(R,{htmlFor:"outlined-adornment-password-login",children:"Old Password"}),e.jsx(T,{id:"oldPassword",name:"oldPassword",type:o?"text":"password",label:"Old Password",value:s.values.oldPassword,onChange:s.handleChange,fullWidth:!0,sx:{padding:1,border:1,borderColor:a.palette.divider,borderRadius:a.shape.borderRadius},error:s.touched.oldPassword&&!!s.errors.oldPassword,endAdornment:e.jsx(z,{position:"end",children:e.jsx(O,{"aria-label":"toggle password visibility",onClick:y,onMouseDown:l,edge:"end",size:"large",children:o?e.jsx(M,{}):e.jsx(U,{})})})}),s.touched.oldPassword&&s.errors.oldPassword&&e.jsx(B,{error:!0,id:"standard-weight-helper-text-oldPassword",children:s.errors.oldPassword})]}),e.jsxs(n,{container:!0,sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:1},children:[e.jsx(n,{item:!0,xs:12,md:5.8,children:e.jsxs(k,{sx:{display:"flex",marginTop:3},error:!!(s.touched.newPassword&&s.errors.newPassword),children:[e.jsx(R,{htmlFor:"outlined-adornment-password-login",children:"New Password"}),e.jsx(T,{id:"outlined-adornment-password-login",type:d?"text":"password",value:s.values.newPassword,name:"newPassword",onChange:s.handleChange,label:"New Password",color:"primary",sx:{padding:1,border:1,borderColor:a.palette.divider,borderRadius:a.shape.borderRadius}}),s.touched.newPassword&&s.errors.newPassword&&e.jsx(B,{error:!0,id:"standard-weight-helper-text-password-login",children:s.errors.newPassword})]})}),e.jsx(n,{item:!0,xs:12,md:5.8,children:e.jsxs(k,{sx:{display:"flex",marginTop:3},error:!!(s.touched.confirmPassword&&s.errors.confirmPassword),children:[e.jsx(R,{htmlFor:"outlined-adornment-password-login",children:"Confirm Password"}),e.jsx(T,{id:"outlined-adornment-password-login",type:d?"text":"password",value:s.values.confirmPassword,name:"confirmPassword",onChange:s.handleChange,endAdornment:e.jsx(z,{position:"end",children:e.jsx(O,{"aria-label":"toggle password visibility",onClick:b,onMouseDown:l,edge:"end",size:"large",children:d?e.jsx(M,{}):e.jsx(U,{})})}),label:"Confirm Password",color:"primary",sx:{padding:1,border:1,borderColor:a.palette.divider,borderRadius:a.shape.borderRadius}}),s.touched.confirmPassword&&s.errors.confirmPassword&&e.jsx(B,{error:!0,id:"standard-weight-helper-text-password-login",children:s.errors.confirmPassword})]})})]}),e.jsx(n,{container:!0,sx:{display:"flex",justifyContent:"flex-end",alignItems:"center"},children:e.jsx(n,{item:!0,xs:12,md:2.8,children:e.jsx(E,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{marginTop:4,boxShadow:0,paddingX:4,paddingY:1.3,borderRadius:2},children:x?e.jsx(V,{size:18,sx:{color:"white"}}):"Save changes"})})})]})]})}),e.jsx(Y,{})]})},ne=()=>{const[a,o]=h.useState(!0),[i,d]=h.useState([]),[u,x]=h.useState(!1);return h.useEffect(()=>((()=>{const y=localStorage.getItem("token"),b=g.auth+g.myProfile,l={Authorization:`Bearer ${y}`,accept:"application/json","Content-Type":"application/json"};fetch(b,{method:"GET",headers:l}).then(s=>s.json()).then(s=>{s.success?(d(s.data),o(!1),x(!1)):(o(!1),x(!1))}).catch(s=>{toast(s.message),x(!0),o(!1)})})(),()=>{}),[]),e.jsx(K,{title:"Account",children:e.jsx(n,{container:!0,alignItems:"center",justifyContent:"center",mt:4,children:e.jsx(n,{item:!0,xs:12,sm:12,md:11.6,lg:11.6,children:a?e.jsx(c,{sx:{padding:4,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(V,{size:22})}):u?e.jsx(D,{severity:"error",title:"Server error",description:"There is error fetching user profile"}):i.length===0?e.jsx(D,{severity:"account",title:"Unable to fetch user information",description:"",sx:{paddingTop:6}}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{userInfo:i}),e.jsx(se,{})]})})})})};export{ne as default};
