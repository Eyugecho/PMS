import{i as z,r as d,j as e,m as B,I,T as m,h as A,a9 as P,C as E,n as T,o as b,G as w,B as R,a2 as K}from"./index-CsFgNO3o.js";import{P as $}from"./MainPage-CJwvk7F6.js";import{P as U}from"./PlanTable-BV9zDlg8.js";import{T as D}from"./TableContainer-qijX9D2r.js";import{T as F,a as G,b as l,c as L}from"./TableRow-CVrgL676.js";import{T as r}from"./TableCell-F9dx6MLR.js";import{K as O,a as H}from"./KeyboardArrowUp-eGxCS8hM.js";import"./index-DK6LBEOt.js";import"./DialogTitle-D1Q0RY_x.js";const N=({units:g})=>{const n=z(),[o,f]=d.useState(null),[k,c]=d.useState(!1),[p,C]=d.useState([]),[S,j]=d.useState(!1),i=(a,t)=>{o===a?f(null):(f(a),u(t))},u=a=>{c(!0);const t=localStorage.getItem("token"),h=b.api+b.getUnitTarget+a,x={Authorization:`Bearer ${t}`,accept:"application/json","Content-Type":"application/json"};fetch(h,{method:"GET",headers:x}).then(s=>s.json()).then(s=>{s.success?(C(s.data),c(!1),j(!1)):(c(!1),j(!1),T.warning(s.data.message))}).catch(s=>{T.warning(s.message),j(!0),c(!1)})};return e.jsx(D,{component:B,sx:{minHeight:"66dvh",border:.4,borderColor:n.palette.grey[300],borderRadius:2},children:e.jsxs(F,{sx:{minWidth:650},"aria-label":"Organization unit table",children:[e.jsx(G,{children:e.jsxs(l,{children:[e.jsx(r,{children:"Unit name"}),e.jsx(r,{children:"Unit Manager"}),e.jsx(r,{children:"Unit Type"}),e.jsx(r,{children:"Action"})]})}),e.jsx(L,{children:g==null?void 0:g.map((a,t)=>{var h,x,s,v,y;return e.jsxs(e.Fragment,{children:[e.jsxs(l,{sx:{backgroundColor:o==t?n.palette.grey[100]:n.palette.background.default,":hover":{backgroundColor:n.palette.grey[100],color:n.palette.background.default,cursor:"pointer",borderRadius:2}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",border:0},children:[e.jsx(I,{"aria-label":"expand row",size:"small",onClick:()=>i(t,a.id),children:o===t?e.jsx(O,{}):e.jsx(H,{})}),e.jsx(m,{variant:"subtitle1",children:a==null?void 0:a.name})]}),e.jsxs(r,{sx:{border:0},children:[(x=(h=a==null?void 0:a.manager)==null?void 0:h.user)==null?void 0:x.name," ",e.jsx(m,{variant:"body2",children:(s=a==null?void 0:a.manager)==null?void 0:s.position})]}),e.jsx(r,{sx:{border:0},children:(v=a==null?void 0:a.unit_type)==null?void 0:v.name}),e.jsx(r,{sx:{border:0},children:e.jsx(A,{variant:"outlined",onClick:()=>i(t,a.id),children:"View"})})]},t),o==t&&e.jsx(l,{sx:{border:0},children:e.jsx(r,{colSpan:7,children:e.jsx(P,{in:o!==null,timeout:"auto",unmountOnExit:!0,children:k?e.jsx(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:4},children:e.jsx(r,{colSpan:7,sx:{border:0},children:e.jsx(E,{size:20})})}):S?e.jsx(l,{sx:{padding:4},children:e.jsx(r,{colSpan:7,sx:{border:0},children:e.jsx(m,{variant:"body2",children:"There is error fetching the unit target"})})}):p.length===0?e.jsx(l,{sx:{padding:4},children:e.jsx(r,{colSpan:7,sx:{border:0},children:e.jsx(m,{variant:"body2",children:"There is no target found"})})}):e.jsx(l,{sx:{},children:e.jsx(r,{colSpan:7,sx:{width:"100%",border:0},children:e.jsx(U,{plans:p,unitName:a==null?void 0:a.name,unitType:(y=a==null?void 0:a.unit_type)==null?void 0:y.name,page:"evaluation"})})})})})})]})})})]})})},V=({employees:g})=>{const n=z(),[o,f]=d.useState(null),[k,c]=d.useState(!1),[p,C]=d.useState([]),[S,j]=d.useState(!1),i=(a,t)=>{o===a?f(null):(f(a),u(t))},u=a=>{c(!0);const t=localStorage.getItem("token"),h=b.api+b.getEmployeeTarget+a,x={Authorization:`Bearer ${t}`,accept:"application/json","Content-Type":"application/json"};fetch(h,{method:"GET",headers:x}).then(s=>s.json()).then(s=>{s.success?(C(s.data),c(!1),j(!1)):(c(!1),j(!1),T.warning(s.data.message))}).catch(s=>{T.warning(s.message),j(!0),c(!1)})};return e.jsx(D,{component:B,sx:{minHeight:"66dvh",border:.4,borderColor:n.palette.grey[300],borderRadius:2},children:e.jsxs(F,{sx:{minWidth:650},"aria-label":"Organization unit table",children:[e.jsx(G,{children:e.jsxs(l,{children:[e.jsx(r,{children:"Employee name"}),e.jsx(r,{children:"Position"}),e.jsx(r,{children:"Email"}),e.jsx(r,{children:"Action"})]})}),e.jsx(L,{children:g==null?void 0:g.map((a,t)=>{var h,x;return e.jsxs(e.Fragment,{children:[e.jsxs(l,{sx:{backgroundColor:o==t?n.palette.grey[100]:n.palette.background.default,":hover":{backgroundColor:n.palette.grey[100],color:n.palette.background.default,cursor:"pointer",borderRadius:2}},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",border:0},children:[e.jsx(I,{"aria-label":"expand row",size:"small",onClick:()=>i(t,a.id),children:o===t?e.jsx(O,{}):e.jsx(H,{})}),e.jsx(m,{variant:"subtitle1",children:(h=a==null?void 0:a.user)==null?void 0:h.name})]}),e.jsx(r,{sx:{border:0},children:a==null?void 0:a.position}),e.jsx(r,{sx:{border:0},children:(x=a==null?void 0:a.user)==null?void 0:x.email}),e.jsx(r,{sx:{border:0},children:e.jsx(A,{variant:"outlined",onClick:()=>i(t,a.id),children:"View"})})]},t),o==t&&e.jsx(l,{sx:{border:0},children:e.jsx(r,{colSpan:7,children:e.jsx(P,{in:o!==null,timeout:"auto",unmountOnExit:!0,children:k?e.jsx(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:4},children:e.jsx(r,{colSpan:7,sx:{border:0},children:e.jsx(E,{size:20})})}):S?e.jsx(l,{sx:{padding:4},children:e.jsx(r,{colSpan:7,sx:{border:0},children:e.jsx(m,{variant:"body2",children:"There is error fetching the employee target"})})}):p.length===0?e.jsx(l,{sx:{padding:4},children:e.jsx(r,{colSpan:7,sx:{border:0},children:e.jsx(m,{variant:"body2",children:"There is no target found"})})}):e.jsx(l,{children:e.jsx(r,{colSpan:7,sx:{width:"100%",border:0},children:e.jsx(U,{plans:p,unitName:a==null?void 0:a.user.name,unitType:a==null?void 0:a.position,page:"evaluation"})})})})})})]})})})]})})},ee=()=>{const[g,n]=d.useState(!0),[o,f]=d.useState([]),[k,c]=d.useState(!1),[p,C]=d.useState("units"),S=i=>{C(i),i!==p&&j(i)},j=i=>{n(!0);const u=localStorage.getItem("token"),a=b.api+b.getDepartments,t=b.api+b.getEmployees,h=i==="employees"?t:a,x={Authorization:`Bearer ${u}`,accept:"application/json","Content-Type":"application/json"};fetch(h,{method:"GET",headers:x}).then(s=>s.json()).then(s=>{s.success?(f(s.data.data),n(!1),c(!1)):(n(!1),c(!1),T.warning(s.data.message))}).catch(s=>{T.warning(s.message),c(!0),n(!1)})};return d.useEffect(()=>(j(),()=>{}),[]),e.jsx($,{back:!0,title:"Evaluations",children:e.jsx(w,{container:!0,children:e.jsxs(w,{item:!0,xs:12,sx:{padding:2},children:[e.jsx(R,{sx:{paddingX:1,marginBottom:2.4},children:e.jsx(R,{sx:{display:"flex",alignItems:"center",marginY:1},children:["units","employees"].map((i,u)=>e.jsx(K,{label:i,sx:{marginLeft:u>0&&2,cursor:"pointer",textTransform:"capitalize",paddingX:2,paddingY:.4},color:"primary",variant:p===i?"filled":"outlined",onClick:()=>S(i),children:i},u))})}),g?e.jsx(w,{container:!0,children:e.jsx(w,{item:!0,xs:12,sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:4},children:e.jsx(E,{size:20})})}):p==="employees"?e.jsx(V,{employees:o}):e.jsx(N,{units:o})]})})})};export{ee as default};
