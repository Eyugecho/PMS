import{l as $,r as i,j as e,q as _,t as U,v as B,w as F,x as d,y as s,z as G,R as I,I as O,b as S,Y as D,aL as L,Z as q,f as A,B as P,h as T,d as Y,n as Q,m as z,C as Z,G as R,ag as J,av as ee,F as ae,ah as se,aj as te}from"./index-DL-CLDEe.js";import{P as H}from"./PlanTable-DGecXshL.js";import{K,a as M}from"./KeyboardArrowUp-C1VMsA8Z.js";const re=({units:p})=>{const l=$(),[o,u]=i.useState(null),[C,j]=i.useState(!1),[v,k]=i.useState([]),[c,b]=i.useState(!1),g=(a,n)=>{o===n?u(null):(u(n),w(n))},w=async a=>{j(!0);const n=await A(),h=T.api+T.getUnitTarget+a,x={Authorization:`Bearer ${n}`,accept:"application/json","Content-Type":"application/json"};fetch(h,{method:"GET",headers:x}).then(t=>t.json()).then(t=>{t.success?(k(t.data),b(!1)):(b(!1),P.warning(t.data.message))}).catch(t=>{P.warning(t.message),b(!0)}).finally(()=>{j(!1)})};return e.jsx(_,{component:U,sx:{minHeight:"66dvh",border:.4,borderColor:l.palette.divider,borderRadius:2},children:e.jsxs(B,{sx:{minWidth:650},"aria-label":"Organization unit table",children:[e.jsx(F,{children:e.jsxs(d,{children:[e.jsx(s,{children:"Unit name"}),e.jsx(s,{children:"Unit Manager"}),e.jsx(s,{children:"Unit Type"}),e.jsx(s,{children:"Action"})]})}),e.jsx(G,{children:p==null?void 0:p.map((a,n)=>{var h,x,t,y,E;return e.jsxs(I.Fragment,{children:[e.jsxs(d,{sx:{backgroundColor:o==(a==null?void 0:a.id)?l.palette.grey[100]:l.palette.background.default,":hover":{backgroundColor:l.palette.grey[100],color:l.palette.background.default,cursor:"pointer",borderRadius:2}},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",border:0},children:[e.jsx(O,{"aria-label":"expand row",size:"small",onClick:()=>g(n,a.id),children:o===(a==null?void 0:a.id)?e.jsx(K,{}):e.jsx(M,{})}),e.jsx(S,{variant:"subtitle1",color:l.palette.text.primary,children:a==null?void 0:a.name})]}),e.jsxs(s,{sx:{border:0},children:[(x=(h=a==null?void 0:a.manager)==null?void 0:h.user)==null?void 0:x.name," ",e.jsx(S,{variant:"body2",children:(t=a==null?void 0:a.manager)==null?void 0:t.position})]}),e.jsx(s,{sx:{border:0},children:(y=a==null?void 0:a.unit_type)==null?void 0:y.name}),e.jsx(s,{sx:{border:0},children:e.jsx(D,{variant:"outlined",onClick:()=>g(n,a.id),children:"View"})})]}),o==(a==null?void 0:a.id)&&e.jsx(d,{sx:{border:0},children:e.jsx(s,{colSpan:7,children:e.jsx(L,{in:o!==null,timeout:"auto",unmountOnExit:!0,children:C?e.jsx(d,{sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:4},children:e.jsx(s,{colSpan:7,sx:{border:0},children:e.jsx(q,{size:20})})}):c?e.jsx(d,{sx:{padding:4},children:e.jsx(s,{colSpan:7,sx:{border:0},children:e.jsx(S,{variant:"body2",children:"There is error fetching the unit target"})})}):v.length===0?e.jsx(d,{sx:{padding:4},children:e.jsx(s,{colSpan:7,sx:{border:0},children:e.jsx(S,{variant:"body2",children:"There is no target found"})})}):e.jsx(d,{children:e.jsx(s,{colSpan:7,sx:{width:"100%",border:0},children:e.jsx(H,{plans:v,unitName:a==null?void 0:a.name,unitType:(E=a==null?void 0:a.unit_type)==null?void 0:E.name,page:"evaluation",onRefresh:()=>w(o)})})})})})})]},a.id)})})]})})},ne=({employees:p})=>{const l=$(),[o,u]=i.useState(null),[C,j]=i.useState(!1),[v,k]=i.useState([]),[c,b]=i.useState(!1),g=a=>{o===a?u(null):(u(a),w(a))},w=async a=>{j(!0);const n=await A(),h=T.api+T.getEmployeeTarget+a,x={Authorization:`Bearer ${n}`,accept:"application/json","Content-Type":"application/json"};fetch(h,{method:"GET",headers:x}).then(t=>t.json()).then(t=>{t.success?(k(t.data),j(!1),b(!1)):(j(!1),b(!1),P.warning(t.data.message))}).catch(t=>{P.warning(t.message),b(!0),j(!1)})};return e.jsx(_,{component:U,sx:{minHeight:"66dvh",border:.4,borderColor:l.palette.divider,borderRadius:2},children:e.jsxs(B,{sx:{minWidth:650},"aria-label":"Organization unit table",children:[e.jsx(F,{children:e.jsxs(d,{children:[e.jsx(s,{children:"Employee name"}),e.jsx(s,{children:"Position"}),e.jsx(s,{children:"Email"}),e.jsx(s,{children:"Action"})]})}),e.jsx(G,{children:p==null?void 0:p.map((a,n)=>{var h,x;return e.jsxs(I.Fragment,{children:[e.jsxs(d,{sx:{backgroundColor:o==a.id?l.palette.grey[100]:l.palette.background.default,":hover":{backgroundColor:l.palette.grey[100],color:l.palette.background.default,cursor:"pointer",borderRadius:2}},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",border:0},children:[e.jsx(O,{"aria-label":"expand row",size:"small",onClick:()=>g(a.id),children:o===a.id?e.jsx(K,{}):e.jsx(M,{})}),e.jsx(S,{variant:"subtitle1",color:l.palette.text.primary,children:(h=a==null?void 0:a.user)==null?void 0:h.name})]}),e.jsx(s,{sx:{border:0},children:a==null?void 0:a.position}),e.jsx(s,{sx:{border:0},children:(x=a==null?void 0:a.user)==null?void 0:x.email}),e.jsx(s,{sx:{border:0},children:e.jsx(D,{variant:"text",onClick:()=>g(a.id),children:"View"})})]}),o==a.id&&e.jsx(d,{sx:{border:0},children:e.jsx(s,{colSpan:7,children:e.jsx(L,{in:o!==null,timeout:"auto",unmountOnExit:!0,children:C?e.jsx(d,{sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:4},children:e.jsx(s,{colSpan:7,sx:{border:0},children:e.jsx(Y,{size:20})})}):c?e.jsx(d,{sx:{padding:4},children:e.jsx(s,{colSpan:7,sx:{border:0},children:e.jsx(S,{variant:"body2",children:"There is error fetching the employee target"})})}):v.length===0?e.jsx(d,{sx:{padding:4},children:e.jsx(s,{colSpan:7,sx:{border:0},children:e.jsx(S,{variant:"body2",children:"There is no target found"})})}):e.jsx(d,{children:e.jsx(s,{colSpan:7,sx:{width:"100%",border:0},children:e.jsx(H,{plans:v,unitName:a==null?void 0:a.user.name,unitType:a==null?void 0:a.position,page:"evaluation",onRefresh:()=>w(o)})})})})})})]},n)})})]})})},de=()=>{const[p,l]=i.useState(!1),[o,u]=i.useState(!0),[C,j]=i.useState([]),[v,k]=i.useState(!1),[c,b]=i.useState("units"),[g,w]=i.useState(""),[a,n]=i.useState({page:0,per_page:10,total:0}),h=r=>{b(r),r!==c&&E(r)},x=r=>{const f=r.target.value;w(f),n({...a,page:0})},t=(r,f)=>{n({...a,page:f})},y=r=>{n({...a,per_page:r.target.value,page:0})},E=async r=>{u(!0);const f=await A(),N=T.api+T.getActiveDepartments+`?page=${a.page}&per_page=${a.per_page}&search=${g}`,V=T.api+T.getActiveEmployees+`?page=${a.page}&per_page=${a.per_page}&search=${g}`,W=r=="employees"?V:N,X={Authorization:`Bearer ${f}`,accept:"application/json","Content-Type":"application/json"};fetch(W,{method:"GET",headers:X}).then(m=>m.json()).then(m=>{m.success?(j(m.data.data),n({...a,total:m.data.total}),k(!1)):P.warning(m.data.message)}).catch(m=>{P.warning(m.message),k(!0)}).finally(()=>{u(!1)})};return i.useEffect(()=>{const r=setTimeout(()=>{E(c)},800);return()=>{clearTimeout(r)}},[g]),i.useEffect(()=>{p?E(c):l(!0)},[a.page,a.per_page]),e.jsxs(Q,{back:!1,title:"Evaluations",rightOption:e.jsx(z,{sx:{display:"flex",alignItems:"center",marginY:1},children:["units","employees"].map((r,f)=>e.jsx(Z,{label:r,sx:{marginLeft:f>0&&2,cursor:"pointer",textTransform:"capitalize",paddingX:2,paddingY:.4},color:"primary",variant:c===r?"filled":"outlined",onClick:()=>h(r)},f))}),children:[e.jsx(R,{container:!0,children:e.jsxs(R,{item:!0,xs:12,sx:{padding:2},children:[e.jsx(z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingX:1,marginY:2},children:e.jsx(J,{value:g,onChange:r=>x(r)})}),o?e.jsx(R,{container:!0,children:e.jsx(R,{item:!0,xs:12,sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:4},children:e.jsx(Y,{size:20})})}):v?e.jsx(ee,{title:"Server Error",message:`Unable to retrive ${c} `}):C.length===0?e.jsx(ae,{severity:"evaluation",title:`${c} are not found`,description:`The list of ${c} will be listed here`,sx:{paddingTop:6}}):c==="employees"?e.jsx(ne,{employees:C}):e.jsx(re,{units:C}),!o&&a.total>a.per_page&&e.jsx(se,{component:"div",rowsPerPageOptions:[10,25,50,100],count:a.total,rowsPerPage:a.per_page,page:a.page,onPageChange:t,onRowsPerPageChange:y})]})}),e.jsx(te,{})]})};export{de as default};
