import{o as O,K as ce,j as e,P as d,p as x,au as je,av as ye,r as i,Y as de,R as ve,a8 as o,J as $,ah as be,v as Ce,aw as ke,as as Ie,ag as G,a0 as p,ax as pe,C as oe,a2 as k,a6 as m,ae as Se,ay as Te,a3 as Me,a9 as ze,aj as Pe,a1 as De,a4 as le,a5 as we,a7 as Ae}from"./index-CB3M8AEN.js";import{f as Be}from"./index-C_-DKd_R.js";import{D as S,I as Re,a as Le,b as _e}from"./DetailInfo-ke-mPU4q.js";import{B as F}from"./Box-DxZ2QpnW.js";import{A as he}from"./ActivityIndicator-DCoQxF--.js";import{a as Ee,c as Ue,b as Fe,D as $e}from"./DialogTitle-By-U4odQ.js";import{P as Ge}from"./PlanTable-D5LXSnc-.js";import{P as Oe}from"./PerformanceCard-DGP5M4nk.js";import{F as Ke}from"./index-DjuwT8zP.js";import{P as Ye}from"./PerKPI-BbJ7VrZd.js";import{I as qe}from"./IconDotsVertical-Me1WCLyu.js";import{I as Ne}from"./IconBuilding-D1kcJ046.js";import{I as Xe}from"./IconTargetArrow-CPLwP0Jj.js";import"./TableContainer-BePYmVWY.js";import"./TableRow-C8yWtStn.js";import"./TableCell-HbngNqTB.js";import"./KeyboardArrowUp-yTYEmYwF.js";import"./DrogaDonutChart-Cs_8_W2m.js";import"./error-DW4k7GIP.js";var Je=O("chair-director","IconChairDirector",[["path",{d:"M6 21l12 -9",key:"svg-0"}],["path",{d:"M6 12l12 9",key:"svg-1"}],["path",{d:"M5 12h14",key:"svg-2"}],["path",{d:"M6 3v9",key:"svg-3"}],["path",{d:"M18 3v9",key:"svg-4"}],["path",{d:"M6 8h12",key:"svg-5"}],["path",{d:"M6 5h12",key:"svg-6"}]]),Ve=O("direction","IconDirection",[["path",{d:"M9 10l3 -3l3 3",key:"svg-0"}],["path",{d:"M9 14l3 3l3 -3",key:"svg-1"}]]),We=O("replace","IconReplace",[["path",{d:"M3 3m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M15 15m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-1"}],["path",{d:"M21 11v-3a2 2 0 0 0 -2 -2h-6l3 3m0 -6l-3 3",key:"svg-2"}],["path",{d:"M3 13v3a2 2 0 0 0 2 2h6l-3 -3m0 6l3 -3",key:"svg-3"}]]);const He=ce(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle"),Qe=ce(e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person"),xe=({content:a,onTitleClick:s,label:l,children:u,sx:f})=>e.jsxs(F,{sx:{display:"flex",flexDirection:"row",alignItems:"center",marginY:1.2,...f},children:[e.jsx(F,{children:u}),e.jsxs(F,{sx:{marginLeft:2},children:[e.jsx(x,{variant:"subtitle1",sx:{maxWidth:"400px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:s,children:a}),e.jsx(x,{variant:"subtitle2",children:l})]})]});xe.propTypes={content:d.any,onTitleClick:d.func,label:d.any,children:d.node,sx:d.object};var K={},Ze=ye;Object.defineProperty(K,"__esModule",{value:!0});var ge=K.default=void 0,ea=Ze(je()),aa=e;ge=K.default=(0,ea.default)((0,aa.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search");const me=({open:a,handleDialogClose:s,unit_id:l,managers:u,isLoading:f,searchText:M,searching:z,onTextChange:P,onSubmit:v})=>{const[h,w]=i.useState(null),[L,j]=i.useState(!1),I=de(),A=t=>{t.key==="Enter"&&(t.preventDefault(),v())},R=t=>{h&&h.id==t.id?w(null):w(t)},_=()=>{j(!0);var t=m.api+m.units+"/"+l;const D={Authorization:"Bearer"+localStorage.getItem("token"),accept:"application/json","Content-Type":"application/json"},E={manager_id:h.id,unit_id:l};fetch(t,{method:"PATCH",headers:D,body:JSON.stringify(E)}).then(y=>y.json()).then(y=>{y.success?(j(!1),s(),k.success(y.data.message)):(j(!1),k.error(y.data.message))}).catch(y=>{j(!1),k.error(y.message)})};return e.jsx(ve.Fragment,{children:e.jsxs(Ee,{open:a,onClose:s,children:[e.jsxs(o,{sx:{position:"sticky",top:0,zIndex:2,width:"100%",backgroundColor:I.palette.primary.main,display:"flex",alignItems:"center",justifyContent:"space-between",paddingRight:2,paddingY:.6},children:[e.jsx(Ue,{variant:"h4",color:I.palette.background.default,children:"Assign Manager"}),e.jsx($,{onClick:s,children:e.jsx(be,{size:20,color:I.palette.background.default})})]}),e.jsxs(Fe,{sx:{width:500,padding:4},children:[e.jsxs(Ce,{component:"form",sx:{border:.6,display:"flex",alignItems:"center"},children:[e.jsx(ke,{sx:{ml:1,px:1.5,flex:1},placeholder:"Search",inputProps:{"aria-label":"search"},value:M,onChange:P,onKeyDown:A}),e.jsx(Ie,{sx:{height:28,m:.5},orientation:"vertical"}),e.jsx($,{type:"button",sx:{p:"8px"},"aria-label":"search",onClick:v,children:z?e.jsx(G,{size:20}):e.jsx(ge,{})})]}),e.jsx(p,{container:!0,children:e.jsx(p,{item:!0,xs:12,children:f?e.jsx(o,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",padding:4},children:e.jsx(G,{size:20})}):e.jsx(o,{sx:{paddingTop:2},children:u.length==0?e.jsxs(o,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:4},children:[e.jsx(pe,{}),e.jsx(x,{variant:"body2",children:"Manager is not found"})]}):u.map(t=>{var b,D;return e.jsxs(o,{onClick:()=>R(t),sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginY:1,padding:1.2,border:1,borderColor:I.palette.divider,borderRadius:2,backgroundColor:h&&h.id===t.id&&I.palette.grey[50],cursor:"pointer"},children:[e.jsx(o,{children:e.jsx(xe,{content:(b=t==null?void 0:t.user)==null?void 0:b.name,label:(D=t==null?void 0:t.user)==null?void 0:D.email,sx:{paddinY:3},children:e.jsx(Qe,{fontSize:"small"})})}),e.jsx(o,{children:h&&h.id===t.id&&e.jsx(He,{color:"primary",fontSize:"small"})})]},t.id)})})})})]}),e.jsxs($e,{sx:{padding:2},children:[e.jsx(oe,{onClick:s,children:"Cancel"}),e.jsx(oe,{onClick:()=>_(),variant:"contained",sx:{paddingX:6},disabled:!h,children:L?e.jsx(he,{size:16}):"Assign"})]})]})})};me.propTypes={open:d.bool,handleDialogClose:d.func,managers:d.array,isLoading:d.bool,searchText:d.string,onTextChange:d.func,onSubmit:d.func,searching:d.bool};function na({icon:a,children:s}){const[l,u]=i.useState(null),f=v=>{u(v.currentTarget)},M=()=>{u(null)},z=!!l,P=z?"popover":void 0;return e.jsxs("div",{children:[e.jsx($,{"aria-describedby":P,onClick:f,children:a}),e.jsx(Se,{id:P,open:z,anchorEl:l,onClose:M,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:s})]})}const T="black",Ca=()=>{var N,X,J,V,W,H,Q,Z,ee,ae,ne,te,se,re;const{state:a}=Te(),s=de(),l=Me(c=>c.customization.selectedFiscalYear),[u,f]=i.useState(!0),[M,z]=i.useState([]),[P,v]=i.useState(!1);i.useState({page:1,per_page:20});const[h,w]=i.useState([]),[L,j]=i.useState(!1),[I,A]=i.useState(!1),[R,_]=i.useState(""),[t,b]=i.useState(!1),D=()=>{A(!0),y()},E=()=>{A(!1)},y=()=>{if(A(!0),h.length==0){j(!0);var c=m.api+m.getManagers,C={Authorization:"Bearer"+localStorage.getItem("token"),accept:"application/json","Content-Type":"application/json"};fetch(c,{method:"GET",headers:C}).then(n=>n.json()).then(n=>{n.success?(j(!1),w(n.data)):(j(!1),k.error(n.data.message))}).catch(n=>{j(!1),k.error(n.message)})}},ue=()=>{b(!0);var c=m.api+m.getManagers+`?search=${R}`,g={Authorization:"Bearer"+localStorage.getItem("token"),accept:"application/json","Content-Type":"application/json"};fetch(c,{method:"GET",headers:g}).then(n=>n.json()).then(n=>{n.success?(b(!1),w(n.data)):(b(!1),handlePrompts(n.message,"error"))}).catch(n=>{b(!1),handlePrompts(n,"error")})},[Y,q]=i.useState(!1),[B,U]=i.useState([]);return i.useEffect(()=>{(async()=>{if(l){q(!0);const C=await we(),g=m.api+m.unitPerformance+`${a==null?void 0:a.id}?fiscal_year_id=${l==null?void 0:l.id}`,n={Authorization:`Bearer ${C}`,accept:"application/json","Content-Type":"application/json"};fetch(g,{method:"GET",headers:n}).then(r=>r.json()).then(r=>{r.success?U(r.data.performance):(U([]),k.warning(r.data.message))}).catch(r=>{U([]),k.warning(r.message)}).finally(()=>{q(!1)})}else return e.jsx(Ae,{})})()},[l]),i.useEffect(()=>((()=>{const C=localStorage.getItem("token"),g=m.api+m.getUnitTarget+(a==null?void 0:a.id),n={Authorization:`Bearer ${C}`,accept:"application/json","Content-Type":"application/json"};fetch(g,{method:"GET",headers:n}).then(r=>r.json()).then(r=>{r.success?(z(r.data),f(!1),v(!1)):(f(!1),v(!1))}).catch(r=>{k(r.message),v(!0),f(!1)})})(),()=>{}),[a==null?void 0:a.id]),e.jsxs(ze,{back:!0,title:"Unit Details",children:[e.jsxs(p,{container:!0,sx:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",padding:2},children:[e.jsxs(p,{item:!0,xs:12,sm:12,md:3.8,lg:3.2,xl:3.2,sx:{background:s.palette.grey[100],color:"#000",borderRadius:2,fontSize:"0.9rem",marginTop:0,borderBottom:`2px solid ${s.palette.divider}`,position:"relative",padding:"12px 16px","&:not(:last-of-type)":{borderRight:`1px solid ${s.palette.divider}`},boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:1,paddingLeft:2,borderBottom:.4,borderColor:s.palette.grey[500]},children:[e.jsx(x,{variant:"h4",children:"Unit Info"}),e.jsx(na,{icon:e.jsx(qe,{size:18}),children:e.jsx(o,{sx:{paddingY:1.6,paddingX:1,backdropFilter:"blur(10px)"},children:e.jsxs(Pe,{sx:{borderRadius:2,padding:1,paddingX:2},onClick:()=>D(),children:[e.jsx(We,{size:20,style:{paddingRight:2}})," ",e.jsx(x,{variant:"body2",marginLeft:1,children:a!=null&&a.manager?"Change manager":"Assign Manager"})]})})})]}),e.jsxs(o,{sx:{padding:2,backgroundColor:s.palette.grey[50],borderRadius:2},children:[(a==null?void 0:a.name)&&e.jsx(S,{label:"Unit name",info:a==null?void 0:a.name,icon:e.jsx(Ne,{size:24,color:T})}),((N=a==null?void 0:a.unit_type)==null?void 0:N.name)&&e.jsx(S,{label:"Unit type",info:(X=a==null?void 0:a.unit_type)==null?void 0:X.name,icon:e.jsx(Ve,{size:24,color:T})}),((V=(J=a==null?void 0:a.manager)==null?void 0:J.user)==null?void 0:V.name)&&e.jsx(S,{label:"Manager name",info:(H=(W=a==null?void 0:a.manager)==null?void 0:W.user)==null?void 0:H.name,icon:e.jsx(pe,{size:24,color:T})}),((Q=a==null?void 0:a.manager)==null?void 0:Q.position)&&e.jsx(S,{label:"Manager Position",info:(Z=a==null?void 0:a.manager)==null?void 0:Z.position,icon:e.jsx(Je,{size:24,color:T})}),((ae=(ee=a==null?void 0:a.manager)==null?void 0:ee.user)==null?void 0:ae.email)&&e.jsx(S,{label:"Manager email",info:(te=(ne=a==null?void 0:a.manager)==null?void 0:ne.user)==null?void 0:te.email,icon:e.jsx(Re,{size:24,color:T})}),(a==null?void 0:a.position)&&e.jsx(S,{label:"Position",info:a==null?void 0:a.position,icon:e.jsx(Le,{size:24,color:T})}),((se=a==null?void 0:a.user)==null?void 0:se.created_at)&&e.jsx(S,{label:"Start date",info:Be((re=a==null?void 0:a.user)==null?void 0:re.created_at).formattedDate,icon:e.jsx(_e,{size:24,color:T})})]})]}),e.jsxs(p,{item:!0,xs:12,sm:12,md:7.9,lg:8.6,xl:8.6,sx:{backgroundColor:s.palette.background.default,border:.4,borderColor:s.palette.grey[200],borderRadius:2},children:[e.jsx(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:1,paddingLeft:2,borderBottom:.4,borderColor:s.palette.grey[200]},children:e.jsx(x,{variant:"h4",children:"Unit KPI's and Targets"})}),e.jsx(o,{children:u?e.jsx(o,{sx:{padding:4,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(G,{size:20})}):P?e.jsx(o,{sx:{padding:4,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(x,{variant:"body2",children:"There is error fetching the unit KPI's"})}):M.length===0?e.jsxs(o,{sx:{padding:4,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx(Xe,{size:80,color:s.palette.grey[400]}),e.jsx(x,{variant:"h4",sx:{marginTop:1.6},children:"Unit target is not found"}),e.jsx(x,{variant:"caption",children:"The list of assigned target will be listed here"})]}):e.jsx(Ge,{plans:M,page:"unit"})})]})]}),e.jsxs(p,{container:!0,sx:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",padding:2},spacing:De,children:[e.jsx(p,{item:!0,xs:12,sm:12,md:4,lg:6,xl:6,children:e.jsxs(le,{children:[e.jsx(x,{variant:"h4",children:"Overall Performance"}),e.jsx(p,{container:!0,children:e.jsx(p,{item:!0,xs:12,children:Y?e.jsx(o,{sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:2},children:e.jsx(he,{size:20})}):B.length>0?e.jsx(p,{container:!0,sx:{marginTop:2,borderTop:.8,borderColor:s.palette.divider,padding:1},children:e.jsx(p,{item:!0,xs:12,sx:{display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"space-between"},children:B==null?void 0:B.map((c,C)=>{var ie;const g=Object.keys(c)[0],[n,r]=g.match(/[a-zA-Z]+|[0-9]+/g),fe=`${n} ${r}`;return e.jsx(Oe,{isEvaluated:c[g].is_evaluated,performance:(ie=c[g])==null?void 0:ie.overall,frequency:fe},C)})})}):e.jsx(Ke,{severity:"performance",title:"No employee performance report",description:"The employee performances will be listed here",sx:{paddingTop:2}})})})]})}),e.jsx(p,{item:!0,xs:12,sm:12,md:8,lg:6,xl:6,children:e.jsxs(le,{children:[e.jsx(x,{variant:"h4",children:"Per KPI performance"}),e.jsx(Ye,{isLoading:Y,performance:B})]})})]}),e.jsx(me,{open:I,handleDialogClose:()=>E(),managers:h,unit_id:a.id,isLoading:L,searchText:R,searching:t,onTextChange:c=>_(c.target.value),onSubmit:()=>ue()})]})};export{Ca as default};
