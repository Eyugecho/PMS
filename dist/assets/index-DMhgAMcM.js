import{c as L,l as R,j as e,R as U,m as p,aG as Je,P as c,aH as Qe,a as G,b as n,aI as Xe,G as a,t as Ve,aJ as Ze,g as N,u as Pe,r as u,n as De,ag as et,d as Se,av as _e,F as Ie,aq as tt,ah as rt,ai as Ae,at as F,aK as st,T as nt,aj as at,B as v,f as it,h as K}from"./index-DL-CLDEe.js";import{I as ot}from"./IconInfoCircle-CPDE5ygq.js";import{S as Ee}from"./SelectorMenu-i2G5QBs3.js";import{A as w}from"./workflow-CsLwfZqg.js";import{P as lt}from"./PlanCard-CFMUCEtq.js";import{D as ct}from"./DrogaDonutChart-gWJPFz3l.js";var Me=L("circle-check-filled","IconCircleCheckFilled",[["path",{d:"M17 3.34a10 10 0 1 1 -14.995 8.984l-.005 -.324l.005 -.324a10 10 0 0 1 14.995 -8.336zm-1.293 5.953a1 1 0 0 0 -1.32 -.083l-.094 .083l-3.293 3.292l-1.293 -1.292l-.094 -.083a1 1 0 0 0 -1.403 1.403l.083 .094l2 2l.094 .083a1 1 0 0 0 1.226 0l.094 -.083l4 -4l.083 -.094a1 1 0 0 0 -.083 -1.32z",fill:"currentColor",key:"svg-0",strokeWidth:"0"}]]),dt=L("circle-x","IconCircleX",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M10 10l4 4m0 -4l-4 4",key:"svg-1"}]]),pt=L("circle","IconCircle",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}]]),xt=L("clipboard-list","IconClipboardList",[["path",{d:"M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2",key:"svg-0"}],["path",{d:"M9 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z",key:"svg-1"}],["path",{d:"M9 12l.01 0",key:"svg-2"}],["path",{d:"M13 12l2 0",key:"svg-3"}],["path",{d:"M9 16l.01 0",key:"svg-4"}],["path",{d:"M13 16l2 0",key:"svg-5"}]]);const ht=({numberOfSteps:s,status:m})=>{R();const i=Array.from({length:s-1},(S,T)=>e.jsxs(U.Fragment,{children:[e.jsx(Me,{size:"1.1rem",stroke:"2",style:{color:"green"}}),e.jsx(p,{sx:{width:12,height:2,backgroundColor:"green"}})]},T)),o=m==="approved"?e.jsx(Me,{size:"1.1rem",stroke:"2",style:{color:"green"}}):m==="rejected"?e.jsx(dt,{size:"1.1rem",stroke:"2",style:{color:"red"}}):m==="amended"?e.jsx(ot,{size:"1.1rem",stroke:"2",style:{color:"orange"}}):e.jsx(pt,{size:"1.1rem",stroke:"2",style:{color:"gray"}});return e.jsx(p,{sx:{marginTop:1},children:e.jsxs(Je,{direction:"row",alignItems:"center",children:[i,o]})})},ze=({type:s,status:m,title:i,description:o,step:S,date:T,onPress:P})=>{const j=R(),A=Qe(j.breakpoints.down("sm"));return e.jsxs(G,{sx:{margin:1,width:A?"98%":"47.5%",":hover":{transform:"scale(1.02)",transition:"all 0.2s ease-in-out",cursor:"pointer"}},onPress:P,children:[e.jsxs(p,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:1.6},children:[e.jsx(p,{sx:{borderRadius:12,backgroundColor:j.palette.grey[50],px:1.4,py:.4},children:e.jsx(n,{variant:"body2",color:j.palette.text.primary,sx:{textTransform:"capitalize"},children:s})}),e.jsx(n,{variant:"subtitle2",sx:{textTransform:"capitalize",color:Xe(m)},children:m})]}),e.jsx(n,{variant:"h3",color:j.palette.text.primary,children:i}),e.jsx(n,{variant:"body2",color:j.palette.text.primary,marginTop:.6,children:o}),e.jsxs(p,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:3},children:[e.jsx(ht,{numberOfSteps:S,status:m}),e.jsx(n,{variant:"subtitle2",children:T})]})]})};ze.propTypes={type:c.string,status:c.string,title:c.string,description:c.string,step:c.number,date:c.string,onPress:c.func};c.bool,c.string,c.node,c.func,c.func,c.func,c.bool;const q=({name:s,position:m})=>{const i=R();return e.jsxs(p,{children:[e.jsx(n,{variant:"subtitle1",color:i.palette.text.primary,children:"Employee"}),s&&e.jsxs(G,{sx:{p:1.4,backgroundColor:i.palette.background.default},children:[e.jsx(n,{variant:"h4",color:i.palette.text.primary,children:s}),e.jsx(n,{variant:"body2",color:i.palette.text.primary,children:m})]})]})};q.propTypes={name:c.string,position:c.string};const H=({name:s,managerName:m,position:i})=>{const o=R();return e.jsxs(p,{mt:2,children:[e.jsx(n,{variant:"subtitle1",color:o.palette.text.primary,children:"Unit"}),e.jsxs(G,{sx:{border:0,p:0},children:[s&&e.jsx(n,{variant:"h3",color:o.palette.text.primary,children:s}),m&&e.jsxs(e.Fragment,{children:[e.jsx(n,{variant:"subtitle2",marginTop:1,children:"Manager"}),e.jsx(n,{variant:"h4",color:o.palette.text.primary,children:m}),e.jsx(n,{variant:"body2",color:o.palette.text.primary,children:i})]})]})]})};H.propTypes={name:c.string,managerName:c.string,position:c.string};const Fe=({evaluation:s,onPress:m,sx:i})=>{var S,T,P,j,A,$,W,E,O,y,_,M,C,Y,x;const o=R();return e.jsxs(G,{onPress:m,sx:{...i},children:[e.jsx(p,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:e.jsx(n,{variant:"body1",children:"KPI Name"})}),e.jsx(n,{variant:"h3",color:o.palette.text.primary,sx:{marginTop:.6},children:(T=(S=s==null?void 0:s.kpi_tracker)==null?void 0:S.kpi)==null?void 0:T.name}),e.jsxs(a,{container:!0,sx:{paddingTop:2},children:[e.jsxs(a,{item:!0,xs:6,sx:{paddingY:2.4},children:[e.jsxs(p,{children:[e.jsx(n,{variant:"body1",children:"Perspective Type"}),e.jsx(n,{variant:"h4",children:(A=(j=(P=s==null?void 0:s.kpi_tracker)==null?void 0:P.kpi)==null?void 0:j.perspective_type)==null?void 0:A.name})]}),e.jsxs(p,{sx:{paddingTop:2},children:[e.jsx(n,{variant:"body1",children:"Measuring Unit"}),e.jsx(n,{variant:"h4",children:(E=(W=($=s==null?void 0:s.kpi_tracker)==null?void 0:$.kpi)==null?void 0:W.measuring_unit)==null?void 0:E.name})]})]}),e.jsxs(a,{item:!0,xs:6,sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:2},children:[e.jsx(ct,{value:(O=s==null?void 0:s.kpi_tracker)==null?void 0:O.weight}),e.jsx(n,{variant:"subtitle1",color:o.palette.text.primary,sx:{marginTop:2},children:"Weight"})]})]}),e.jsxs(a,{container:!0,marginTop:1,children:[e.jsx(a,{item:!0,xs:6,children:e.jsxs(p,{children:[e.jsx(n,{variant:"body1",color:o.palette.text.primary,children:"Frequency"}),e.jsx(n,{variant:"h4",children:(_=(y=s==null?void 0:s.period)==null?void 0:y.frequency)==null?void 0:_.name})]})}),e.jsx(a,{item:!0,xs:6,children:e.jsxs(Ve,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:1.6,backgroundColor:o.palette.grey[50]},children:[e.jsx(n,{variant:"subtitle1",color:o.palette.text.primary,children:"Target"}),e.jsxs(n,{variant:"h4",children:[(M=s==null?void 0:s.kpi_tracker)==null?void 0:M.total_target,Ze((x=(Y=(C=s==null?void 0:s.kpi_tracker)==null?void 0:C.kpi)==null?void 0:Y.measuring_unit)==null?void 0:x.name)]})]})})]}),e.jsxs(a,{container:!0,sx:{display:"flex",flexDirection:"column",marginTop:3,borderTop:.8,borderColor:o.palette.divider,padding:.8,paddingTop:2},spacing:N,children:[e.jsx(n,{variant:"h4",color:o.palette.text.primary,children:"Quarter 1"}),e.jsxs(a,{item:!0,xs:12,sx:{display:"flex",alignItems:"center"},children:[e.jsx(n,{variant:"subtitle1",color:o.palette.text.primary,children:"Targeted"}),e.jsx(p,{sx:{padding:1,m:1,backgroundColor:o.palette.grey[50],borderRadius:2},children:e.jsx(n,{variant:"h4",color:o.palette.text.primary,children:s==null?void 0:s.target})})]}),e.jsxs(a,{item:!0,xs:12,sx:{display:"flex",alignItems:"center"},children:[e.jsx(n,{variant:"subtitle1",color:o.palette.text.primary,children:"Evaluated"}),e.jsx(p,{sx:{padding:1,m:1,backgroundColor:o.palette.grey[50],borderRadius:2},children:e.jsx(n,{variant:"h4",color:o.palette.text.primary,children:s==null?void 0:s.actual_value})})]})]})]})};Fe.propTypes={evaluation:c.object,onPress:c.func,sx:c.object};const mt=[{label:"All Status",value:""},{label:"Pending",value:"pending"},{label:"Approved",value:"approved"},{label:"Rejected",value:"rejected"},{label:"Amended",value:"amended"}],bt=()=>{var D,ee,te,re,se,ne,ae,ie,oe,le,ce,de,pe,xe,he,me,ge,ue,je,ye,fe,ke,be,ve,Te,Ce,we;const s=R(),m=Pe(r=>r.customization.selectedFiscalYear),i=Pe(r=>r.user.user),[o,S]=u.useState(!1),[T,P]=u.useState(!0),[j,A]=u.useState([]),[$,W]=u.useState(!1),[E,O]=u.useState(""),[y,_]=u.useState({page:0,per_page:10,total:0}),[M]=u.useState([{label:"All Types",value:""}]),[C,Y]=u.useState({type:"",status:"",sort:!1}),[x,Re]=u.useState(),J=r=>{const{value:l,name:d}=r.target;Y({...C,[d]:l})},[$e,Q]=u.useState(!1),[t,X]=u.useState([]),[f,B]=u.useState({type:"",comment:"",openModal:!1,submitting:!1}),z=r=>{B({...f,type:r,openModal:!0})},We=r=>{const l=r.target.value;B({...f,comment:l})},V=()=>{B({...f,openModal:!1})},Be=r=>{var l;if(r.preventDefault(),x&&i&&f.type){B({...f,submitting:!0});const d=w.api+w.taskAction,k={Authorization:`${w.API_KEY}`,accept:"application/json","Content-Type":"application/json"},b=[];(l=i==null?void 0:i.roles)==null||l.forEach(g=>b.push({role_id:g.uuid,role_name:g.name}));const h={result:f.type,comments:f.comment,roles:b,task_id:x==null?void 0:x.id,user_id:i==null?void 0:i.id};fetch(d,{method:"POST",headers:k,body:JSON.stringify(h)}).then(g=>g.json()).then(g=>{g.success?v.success(g.message):v.warning(g.message)}).catch(g=>{v.warning(g.message)}).finally(()=>{B({...f,submitting:!1})})}},Ge=r=>{const l=r.target.value;O(l),_({...y,page:0})},Oe=(r,l)=>{_({...y,page:l})},Ye=r=>{_({...y,per_page:r.target.value,page:0})},Ke=r=>{M.length<2&&r.forEach(l=>M.push({label:l.name,value:l.id}))},Ne=async()=>{const r=w.api+w.id+"/workflows",l={Authorization:`${w.API_KEY}`,accept:"application/json"};fetch(r,{method:"GET",headers:l}).then(d=>d.json()).then(d=>{var k,b,h,g;d.success?(b=(k=d==null?void 0:d.data)==null?void 0:k.applicationWorkflows)!=null&&b.workflows&&Ke((g=(h=d==null?void 0:d.data)==null?void 0:h.applicationWorkflows)==null?void 0:g.workflows):v.warning(d.data.message)}).catch(d=>{v.error(d.message)}).finally(()=>{P(!1)})},Z=async()=>{var r;if(m){P(!0);const l=w.api+w.tasks+`?page=${y.page}&per_page=${y.per_page}&search=${E}&type=${C.type}&status=${C.status}`,d={Authorization:`${w.API_KEY}`,accept:"application/json","Content-Type":"application/json"},k=[];(r=i==null?void 0:i.roles)==null||r.forEach(h=>k.push({role_id:h.uuid,role_name:h.name}));const b={user_id:i==null?void 0:i.id,roles:k};fetch(l,{method:"POST",headers:d,body:JSON.stringify(b)}).then(h=>h.json()).then(h=>{h.success?(A(h.data.tasks),_({...y,total:h.data.total}),W(!1)):v.warning(h.message)}).catch(h=>{v.warning(h.message),W(!0)}).finally(()=>{P(!1)})}},Le=async r=>{var l,d,k,b;if((l=r==null?void 0:r.data)!=null&&l.id){Re(r),Q(!0);const h=await it(),g=K.api+K.showPlan+`/${(d=r==null?void 0:r.data)==null?void 0:d.id}`,Ue=K.api+K.showTarget+`${(k=r==null?void 0:r.data)==null?void 0:k.id}`,qe=((b=r.workflow)==null?void 0:b.name)==="Evaluation"?Ue:g,He={Authorization:`Bearer ${h}`,accept:"application/json","Content-Type":"application/json"};fetch(qe,{method:"GET",headers:He}).then(I=>I.json()).then(I=>{I.success?X(I.data):(X([]),v.warning(I.message))}).catch(I=>{v.warning(I.message)}).finally(()=>{Q(!1)})}else v.error("There is error fetching task detail")};return u.useEffect(()=>{Ne()},[]),u.useEffect(()=>{const r=setTimeout(()=>{Z()},500);return()=>{clearTimeout(r)}},[E]),u.useEffect(()=>{o?Z():S(!0)},[m,y.page,y.per_page,C]),e.jsxs(De,{title:"Tasks",children:[e.jsx(a,{container:!0,padding:2.4,children:e.jsxs(a,{container:!0,spacing:N,marginTop:.2,children:[e.jsx(a,{item:!0,xs:12,sm:12,md:8,lg:8,xl:8,children:e.jsxs(p,{sx:{minHeight:400},children:[e.jsxs(p,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:3,px:2},children:[e.jsx(p,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsx(et,{value:E,onChange:r=>Ge(r)})}),e.jsxs(p,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(p,{sx:{marginRight:2},children:e.jsx(Ee,{name:"type",options:M,selected:C.type,handleSelection:J})}),e.jsx(Ee,{name:"status",options:mt,selected:C.status,handleSelection:J})]})]}),e.jsx(a,{container:!0,children:T?e.jsx(a,{container:!0,children:e.jsx(a,{item:!0,xs:12,sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:4},children:e.jsx(Se,{size:20})})}):$?e.jsx(_e,{title:"Server Error",message:"There is error retriving tasks"}):j.length===0?e.jsx(Ie,{severity:"tasks",title:"Tasks are not found",description:"The list of task will be listed here",sx:{paddingTop:6}}):e.jsx(a,{item:!0,xs:12,sm:12,sx:{display:"flex",flexWrap:"wrap"},children:j==null?void 0:j.map((r,l)=>e.jsx(ze,{type:r.workflow.name,status:r.status,title:r.title,description:r.description,step:r.step,date:tt(r.created_at).formattedDate,onPress:()=>Le(r)},l))})}),!T&&j.length>0&&e.jsx(rt,{component:"div",rowsPerPageOptions:[10,25,50,100],count:y.total,rowsPerPage:y.per_page,page:y.page,onPageChange:Oe,onRowsPerPageChange:Ye,labelRowsPerPage:"Items per page"})]})}),e.jsx(a,{item:!0,xs:12,sm:12,md:4,lg:4,xl:4,children:e.jsxs(G,{sx:{minHeight:240},children:[e.jsx(n,{variant:"h4",children:"Task Details"}),x&&t?e.jsx(a,{container:!0,sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:$e?e.jsx(a,{container:!0,children:e.jsx(a,{item:!0,xs:12,sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:4},children:e.jsx(Se,{size:20})})}):$?e.jsx(_e,{title:"Server Error",message:"There is error retriving task detail"}):t.length===0?e.jsx(Ie,{severity:"tasks",title:"Tasks details is not found",description:"The detail of task is shown here",sx:{paddingTop:6}}):((D=x==null?void 0:x.workflow)==null?void 0:D.name)==="Planning"?e.jsxs(a,{item:!0,xs:12,children:[(t==null?void 0:t.employee)&&e.jsx(q,{name:(te=(ee=t==null?void 0:t.employee)==null?void 0:ee.user)==null?void 0:te.name,position:(re=t==null?void 0:t.employee)==null?void 0:re.position}),(t==null?void 0:t.unit)&&e.jsx(H,{name:(se=t==null?void 0:t.unit)==null?void 0:se.name,managerName:(ie=(ae=(ne=t==null?void 0:t.unit)==null?void 0:ne.manager)==null?void 0:ae.user)==null?void 0:ie.name,position:(le=(oe=t==null?void 0:t.unit)==null?void 0:oe.manager)==null?void 0:le.position}),e.jsx(Ae,{sx:{borderColor:s.palette.divider,my:1.4}}),(t==null?void 0:t.target)&&e.jsx(lt,{plan:{...t},sx:{border:0,p:.4,my:3}}),(x==null?void 0:x.status)==="pending"&&e.jsxs(U.Fragment,{children:[e.jsx(F,{title:"Approve",variant:"contained",sx:{backgroundColor:"green",":hover":{backgroundColor:"green"},width:"100%",boxShadow:0,p:1.4,marginTop:2},onPress:()=>z("approved")}),e.jsxs(a,{container:!0,mt:1,spacing:N,children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(F,{title:"Amend",variant:"text",sx:{width:"100%"},onPress:()=>z("amended")})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(F,{title:"Reject",variant:"text",color:"error",sx:{width:"100%"},onPress:()=>z("rejected")})})]})]})]}):((ce=x.workflow)==null?void 0:ce.name)==="Evaluation"?e.jsxs(a,{item:!0,xs:12,children:[((de=t==null?void 0:t.kpi_tracker)==null?void 0:de.employee)&&e.jsx(q,{name:(he=(xe=(pe=t==null?void 0:t.kpi_tracker)==null?void 0:pe.employee)==null?void 0:xe.user)==null?void 0:he.name,position:(ge=(me=t==null?void 0:t.kpi_tracker)==null?void 0:me.employee)==null?void 0:ge.position}),((ue=t==null?void 0:t.kpi_tracker)==null?void 0:ue.unit)&&e.jsx(H,{name:(ye=(je=t==null?void 0:t.kpi_tracker)==null?void 0:je.unit)==null?void 0:ye.name,managerName:(ve=(be=(ke=(fe=t==null?void 0:t.kpi_tracker)==null?void 0:fe.unit)==null?void 0:ke.manager)==null?void 0:be.user)==null?void 0:ve.name,position:(we=(Ce=(Te=t==null?void 0:t.kpi_tracker)==null?void 0:Te.unit)==null?void 0:Ce.manager)==null?void 0:we.position}),e.jsx(Ae,{sx:{borderColor:s.palette.divider,my:1.4}}),t&&e.jsx(Fe,{evaluation:{...t},sx:{border:0,p:.4,my:3}}),(x==null?void 0:x.status)==="pending"&&e.jsxs(U.Fragment,{children:[e.jsx(F,{title:"Approve",variant:"contained",sx:{backgroundColor:"green",":hover":{backgroundColor:"green"},width:"100%",boxShadow:0,p:1.4,marginTop:2},onPress:()=>z("approved")}),e.jsxs(a,{container:!0,mt:1,spacing:N,children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(F,{title:"Amend",variant:"text",sx:{width:"100%"},onPress:()=>z("amended")})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(F,{title:"Reject",variant:"text",color:"error",sx:{width:"100%"},onPress:()=>z("rejected")})})]})]})]}):e.jsx(n,{variant:"subtitle1",children:" The task does not have categorized type"})}):e.jsxs(p,{sx:{margin:6,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx(xt,{size:"3rem",stroke:"1.2",color:"grey"}),e.jsx(n,{variant:"h4",color:s.palette.text.primary,mt:1.6,children:"Selected task detail view"}),e.jsx(n,{variant:"subtitle2",children:"The detail of task you choosed shown here"})]})]})})]})}),e.jsx(st,{open:f.openModal,title:"Remark",handleClose:V,onCancel:V,onSubmit:Be,submitting:f.submitting,children:e.jsx(nt,{multiline:!0,minRows:5,name:"remark",value:f.comment,onChange:We,placeholder:"Write remark here",variant:"standard",fullWidth:!0})}),e.jsx(at,{})]})};export{bt as default};
