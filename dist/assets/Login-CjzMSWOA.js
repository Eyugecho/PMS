import{P as _,j as e,bp as G,m as x,l as H,c4 as U,u as q,r as w,bT as N,M as R,N as y,G as t,U as b,V as S,W as I,X as j,b1 as $,I as O,a9 as V,c5 as J,aG as T,c6 as Q,c7 as X,Y,d as K,h as k,c8 as Z,ay as v,c9 as ee,ca as se,cb as te,cc as ne,aH as ie,cd as ae,ce as re,b as C}from"./index-DL-CLDEe.js";import{A as oe}from"./AuthFooter-BiCohCRu.js";import"./Link-B6smJYlO.js";const A=({children:o,...l})=>e.jsx(G,{sx:{maxWidth:{xs:400,lg:475},margin:{xs:2.5,md:3},"& > *":{flexGrow:1,flexBasis:"50%"}},content:!1,...l,children:e.jsx(x,{sx:{p:{xs:2,sm:3,xl:2}},children:o})});A.propTypes={children:_.node};const le=({...o})=>{const l=H(),u=U(),B=q(s=>s.customization),[p,P]=w.useState(!1),[g,f]=w.useState(!1),z=()=>P(!p),E=s=>s.preventDefault(),M=async(s,{setErrors:a,setStatus:r,setSubmitting:d})=>{try{f(!0);const n=k.auth+k.login,m={email:s.email,password:s.password};fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}).then(i=>i.json()).then(i=>{if(i.success){const{access_token:h}=i.data;if(typeof h!="string")throw new Error("Invalid token format");const c=Z(h),D={id:c.sub,name:c.name,email:c.email,roles:c.roles,permissions:c.roles.flatMap(W=>W.permissions)},F=new Date().getTime(),L=i.data.expires_in*1e3+F;v.setItem("token",h),v.setItem("tokenExpiration",L),u(ee({type:se,user:D})),u(te()),u({type:ne,signed:!0})}else r({success:!1}),a({submit:i.data.message}),d(!1)}).catch(i=>{r({success:!1}),a({submit:i.message}),d(!1)}).finally(()=>{f(!1)})}catch(n){r({success:!1}),a({submit:n.message}),d(!1)}};return e.jsx(N,{initialValues:{email:"",password:"",submit:null},validationSchema:R().shape({email:y().email("Must be a valid email").max(255).required("Email is required"),password:y().max(255).required("Password is required")}),onSubmit:M,children:({errors:s,handleBlur:a,handleChange:r,handleSubmit:d,touched:n,values:m})=>e.jsxs("form",{noValidate:!0,onSubmit:d,...o,children:[e.jsx(t,{container:!0,direction:"column",justifyContent:"center",spacing:2,children:e.jsx(t,{item:!0,xs:12,container:!0,alignItems:"center",justifyContent:"center",children:e.jsx(x,{sx:{mb:3}})})}),e.jsxs(b,{style:{display:"flex"},error:!!(n.email&&s.email),children:[e.jsx(S,{htmlFor:"outlined-adornment-email-login",style:{fontSize:"12px"},children:"Email Address"}),e.jsx(I,{id:"outlined-adornment-email-login",type:"email",value:m.email,sx:{marginBottom:"16px"},name:"email",onBlur:a,onChange:r,label:"Email Address",inputProps:{}}),n.email&&s.email&&e.jsx(j,{error:!0,id:"standard-weight-helper-text-email-login",children:s.email})]}),e.jsxs(b,{style:{display:"flex",marginTop:2},error:!!(n.password&&s.password),children:[e.jsx(S,{htmlFor:"outlined-adornment-password-login",style:{fontSize:"12px"},children:"Password"}),e.jsx(I,{id:"outlined-adornment-password-login",type:p?"text":"password",value:m.password,name:"password",sx:{marginBottom:"16px"},onBlur:a,onChange:r,endAdornment:e.jsx($,{position:"end",children:e.jsx(O,{"aria-label":"toggle password visibility",onClick:z,onMouseDown:E,edge:"end",size:"large",children:p?e.jsx(V,{fontSize:"small"}):e.jsx(J,{fontSize:"small"})})}),label:"Password",color:"primary"}),n.password&&s.password&&e.jsx(j,{error:!0,id:"standard-weight-helper-text-password-login",children:s.password})]}),e.jsx(T,{direction:"row",alignItems:"center",justifyContent:"flex-end",spacing:1,children:e.jsx(Q,{to:"/forgot-password",variant:"subtitle1",sx:{textDecoration:"none",cursor:"pointer"},children:"Forgot Password?"})}),s.submit&&e.jsx(x,{sx:{mt:3},children:e.jsx(j,{error:!0,children:s.submit})}),e.jsx(x,{sx:{mt:4},children:e.jsx(X,{children:e.jsx(Y,{disableElevation:!0,disabled:g,fullWidth:!0,size:"large",type:"submit",variant:"contained",sx:{padding:1.6,transition:"all .2s ease-in-out",'&[aria-controls="menu-list-grow"],&:hover':{background:l.palette.primary.dark},borderRadius:`${B.borderRadius}px`},children:g?e.jsx(K,{size:18}):"Sign in"})})})]})})},ue=()=>{const o=ie(l=>l.breakpoints.down("md"));return e.jsx(ae,{children:e.jsxs(t,{container:!0,direction:"column",justifyContent:"flex-end",sx:{minHeight:"100vh"},children:[e.jsx(t,{item:!0,xs:12,children:e.jsx(t,{container:!0,justifyContent:"center",alignItems:"center",sx:{minHeight:"calc(100vh - 68px)"},children:e.jsx(t,{item:!0,sx:{m:{xs:1,sm:3},mb:0},children:e.jsx(A,{children:e.jsxs(t,{container:!0,spacing:2,alignItems:"center",justifyContent:"center",children:[e.jsx(t,{item:!0,children:e.jsx(re,{})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(t,{container:!0,direction:{xs:"column-reverse",md:"row"},alignItems:"center",justifyContent:"center",children:e.jsx(t,{item:!0,children:e.jsxs(T,{alignItems:"center",justifyContent:"center",spacing:1,children:[e.jsx(C,{color:"primary.main",gutterBottom:!0,variant:o?"h3":"h2",children:"Hi, Welcome"}),e.jsx(C,{variant:"caption",fontSize:"16px",textAlign:{xs:"center",md:"inherit"},children:"Enter your credentials to continue"})]})})})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(le,{})})]})})})})}),e.jsx(t,{item:!0,xs:12,sx:{m:3,mt:1},children:e.jsx(oe,{})})]})})};export{ue as default};
