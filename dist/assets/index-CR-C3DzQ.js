import{Y as z,r as i,j as e,v as _,R as U,J as B,p as w,C as F,aO as O,ag as J,a5 as A,a2 as P,a6 as T,a9 as Q,a8 as $,E as q,a0 as R,at as Z}from"./index-CB3M8AEN.js";import{P as D}from"./PlanTable-D5LXSnc-.js";import{T as G}from"./TableContainer-BePYmVWY.js";import{T as I,a as L,b as c,c as Y}from"./TableRow-C8yWtStn.js";import{T as s}from"./TableCell-HbngNqTB.js";import{K as H,a as K}from"./KeyboardArrowUp-yTYEmYwF.js";import{A as M}from"./ActivityIndicator-DCoQxF--.js";import{S as ee}from"./search-BIP7CrFZ.js";import{E as ae}from"./ErrorPrompt-fWlGKA_A.js";import{F as se}from"./index-DjuwT8zP.js";import{T as re}from"./TablePagination-DbGtClqp.js";import"./index-C_-DKd_R.js";import"./DialogTitle-By-U4odQ.js";import"./error-DW4k7GIP.js";import"./KeyboardArrowRight-4XYPRTPY.js";import"./LastPage-Z-YOeIDc.js";const te=({units:p})=>{const l=z(),[o,f]=i.useState(null),[C,j]=i.useState(!1),[v,E]=i.useState([]),[d,b]=i.useState(!1),g=(a,n)=>{o===n?f(null):(f(n),S(n))},S=async a=>{j(!0);const n=await A(),h=T.api+T.getUnitTarget+a,x={Authorization:`Bearer ${n}`,accept:"application/json","Content-Type":"application/json"};fetch(h,{method:"GET",headers:x}).then(r=>r.json()).then(r=>{r.success?(E(r.data),b(!1)):(b(!1),P.warning(r.data.message))}).catch(r=>{P.warning(r.message),b(!0)}).finally(()=>{j(!1)})};return e.jsx(G,{component:_,sx:{minHeight:"66dvh",border:.4,borderColor:l.palette.divider,borderRadius:2},children:e.jsxs(I,{sx:{minWidth:650},"aria-label":"Organization unit table",children:[e.jsx(L,{children:e.jsxs(c,{children:[e.jsx(s,{children:"Unit name"}),e.jsx(s,{children:"Unit Manager"}),e.jsx(s,{children:"Unit Type"}),e.jsx(s,{children:"Action"})]})}),e.jsx(Y,{children:p==null?void 0:p.map((a,n)=>{var h,x,r,y,k;return e.jsxs(U.Fragment,{children:[e.jsxs(c,{sx:{backgroundColor:o==(a==null?void 0:a.id)?l.palette.grey[100]:l.palette.background.default,":hover":{backgroundColor:l.palette.grey[100],color:l.palette.background.default,cursor:"pointer",borderRadius:2}},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",border:0},children:[e.jsx(B,{"aria-label":"expand row",size:"small",onClick:()=>g(n,a.id),children:o===(a==null?void 0:a.id)?e.jsx(H,{}):e.jsx(K,{})}),e.jsx(w,{variant:"subtitle1",color:l.palette.text.primary,children:a==null?void 0:a.name})]}),e.jsxs(s,{sx:{border:0},children:[(x=(h=a==null?void 0:a.manager)==null?void 0:h.user)==null?void 0:x.name," ",e.jsx(w,{variant:"body2",children:(r=a==null?void 0:a.manager)==null?void 0:r.position})]}),e.jsx(s,{sx:{border:0},children:(y=a==null?void 0:a.unit_type)==null?void 0:y.name}),e.jsx(s,{sx:{border:0},children:e.jsx(F,{variant:"outlined",onClick:()=>g(n,a.id),children:"View"})})]}),o==(a==null?void 0:a.id)&&e.jsx(c,{sx:{border:0},children:e.jsx(s,{colSpan:7,children:e.jsx(O,{in:o!==null,timeout:"auto",unmountOnExit:!0,children:C?e.jsx(c,{sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:4},children:e.jsx(s,{colSpan:7,sx:{border:0},children:e.jsx(J,{size:20})})}):d?e.jsx(c,{sx:{padding:4},children:e.jsx(s,{colSpan:7,sx:{border:0},children:e.jsx(w,{variant:"body2",children:"There is error fetching the unit target"})})}):v.length===0?e.jsx(c,{sx:{padding:4},children:e.jsx(s,{colSpan:7,sx:{border:0},children:e.jsx(w,{variant:"body2",children:"There is no target found"})})}):e.jsx(c,{children:e.jsx(s,{colSpan:7,sx:{width:"100%",border:0},children:e.jsx(D,{plans:v,unitName:a==null?void 0:a.name,unitType:(k=a==null?void 0:a.unit_type)==null?void 0:k.name,page:"evaluation",onRefresh:()=>S(o)})})})})})})]},a.id)})})]})})},ne=({employees:p})=>{const l=z(),[o,f]=i.useState(null),[C,j]=i.useState(!1),[v,E]=i.useState([]),[d,b]=i.useState(!1),g=a=>{o===a?f(null):(f(a),S(a))},S=async a=>{j(!0);const n=await A(),h=T.api+T.getEmployeeTarget+a,x={Authorization:`Bearer ${n}`,accept:"application/json","Content-Type":"application/json"};fetch(h,{method:"GET",headers:x}).then(r=>r.json()).then(r=>{r.success?(E(r.data),j(!1),b(!1)):(j(!1),b(!1),P.warning(r.data.message))}).catch(r=>{P.warning(r.message),b(!0),j(!1)})};return e.jsx(G,{component:_,sx:{minHeight:"66dvh",border:.4,borderColor:l.palette.divider,borderRadius:2},children:e.jsxs(I,{sx:{minWidth:650},"aria-label":"Organization unit table",children:[e.jsx(L,{children:e.jsxs(c,{children:[e.jsx(s,{children:"Employee name"}),e.jsx(s,{children:"Position"}),e.jsx(s,{children:"Email"}),e.jsx(s,{children:"Action"})]})}),e.jsx(Y,{children:p==null?void 0:p.map((a,n)=>{var h,x;return e.jsxs(U.Fragment,{children:[e.jsxs(c,{sx:{backgroundColor:o==a.id?l.palette.grey[100]:l.palette.background.default,":hover":{backgroundColor:l.palette.grey[100],color:l.palette.background.default,cursor:"pointer",borderRadius:2}},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",border:0},children:[e.jsx(B,{"aria-label":"expand row",size:"small",onClick:()=>g(a.id),children:o===a.id?e.jsx(H,{}):e.jsx(K,{})}),e.jsx(w,{variant:"subtitle1",color:l.palette.text.primary,children:(h=a==null?void 0:a.user)==null?void 0:h.name})]}),e.jsx(s,{sx:{border:0},children:a==null?void 0:a.position}),e.jsx(s,{sx:{border:0},children:(x=a==null?void 0:a.user)==null?void 0:x.email}),e.jsx(s,{sx:{border:0},children:e.jsx(F,{variant:"text",onClick:()=>g(a.id),children:"View"})})]}),o==a.id&&e.jsx(c,{sx:{border:0},children:e.jsx(s,{colSpan:7,children:e.jsx(O,{in:o!==null,timeout:"auto",unmountOnExit:!0,children:C?e.jsx(c,{sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:4},children:e.jsx(s,{colSpan:7,sx:{border:0},children:e.jsx(M,{size:20})})}):d?e.jsx(c,{sx:{padding:4},children:e.jsx(s,{colSpan:7,sx:{border:0},children:e.jsx(w,{variant:"body2",children:"There is error fetching the employee target"})})}):v.length===0?e.jsx(c,{sx:{padding:4},children:e.jsx(s,{colSpan:7,sx:{border:0},children:e.jsx(w,{variant:"body2",children:"There is no target found"})})}):e.jsx(c,{children:e.jsx(s,{colSpan:7,sx:{width:"100%",border:0},children:e.jsx(D,{plans:v,unitName:a==null?void 0:a.user.name,unitType:a==null?void 0:a.position,page:"evaluation",onRefresh:()=>S(o)})})})})})})]},n)})})]})})},ve=()=>{const[p,l]=i.useState(!1),[o,f]=i.useState(!0),[C,j]=i.useState([]),[v,E]=i.useState(!1),[d,b]=i.useState("units"),[g,S]=i.useState(""),[a,n]=i.useState({page:0,per_page:10,total:0}),h=t=>{b(t),t!==d&&k(t)},x=t=>{const m=t.target.value;S(m),n({...a,page:0})},r=(t,m)=>{n({...a,page:m})},y=t=>{n({...a,per_page:t.target.value,page:0})},k=async t=>{f(!0);const m=await A(),N=T.api+T.getActiveDepartments+`?page=${a.page}&per_page=${a.per_page}&search=${g}`,V=T.api+T.getActiveEmployees+`?page=${a.page}&per_page=${a.per_page}&search=${g}`,W=t=="employees"?V:N,X={Authorization:`Bearer ${m}`,accept:"application/json","Content-Type":"application/json"};fetch(W,{method:"GET",headers:X}).then(u=>u.json()).then(u=>{u.success?(j(u.data.data),n({...a,total:u.data.total}),E(!1)):P.warning(u.data.message)}).catch(u=>{P.warning(u.message),E(!0)}).finally(()=>{f(!1)})};return i.useEffect(()=>{const t=setTimeout(()=>{k(d)},800);return()=>{clearTimeout(t)}},[g]),i.useEffect(()=>{p?k(d):l(!0)},[a.page,a.per_page]),e.jsxs(Q,{back:!1,title:"Evaluations",rightOption:e.jsx($,{sx:{display:"flex",alignItems:"center",marginY:1},children:["units","employees"].map((t,m)=>e.jsx(q,{label:t,sx:{marginLeft:m>0&&2,cursor:"pointer",textTransform:"capitalize",paddingX:2,paddingY:.4},color:"primary",variant:d===t?"filled":"outlined",onClick:()=>h(t)},m))}),children:[e.jsx(R,{container:!0,children:e.jsxs(R,{item:!0,xs:12,sx:{padding:2},children:[e.jsx($,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingX:1,marginY:2},children:e.jsx(ee,{value:g,onChange:t=>x(t)})}),o?e.jsx(R,{container:!0,children:e.jsx(R,{item:!0,xs:12,sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:4},children:e.jsx(M,{size:20})})}):v?e.jsx(ae,{title:"Server Error",message:`Unable to retrive ${d} `}):C.length===0?e.jsx(se,{severity:"evaluation",title:`${d} are not found`,description:`The list of ${d} will be listed here`,sx:{paddingTop:6}}):d==="employees"?e.jsx(ne,{employees:C}):e.jsx(te,{units:C}),!o&&a.total>a.per_page&&e.jsx(re,{component:"div",rowsPerPageOptions:[10,25,50,100],count:a.total,rowsPerPage:a.per_page,page:a.page,onPageChange:r,onRowsPerPageChange:y})]})}),e.jsx(Z,{})]})};export{ve as default};
