import{P as q,j as e,b1 as H,a8 as x,Y as W,a3 as G,bD as N,ak as R,r as w,bn as $,ab as J,ac as b,a0 as t,S as y,U as S,af as I,V as h,I as O,J as U,ao as V,bE as K,aM as A,bF as Q,bf as Y,C as X,a6 as C,bG as Z,aC as k,bH as ee,bI as se,bJ as te,q as ne,bK as ie,bL as ae,p as v}from"./index-CB3M8AEN.js";import{A as re}from"./ActivityIndicator-DCoQxF--.js";import{A as oe}from"./AuthFooter-C9qpayME.js";import"./Link-2tXoNvDO.js";const T=({children:o,...l})=>e.jsx(H,{sx:{maxWidth:{xs:400,lg:475},margin:{xs:2.5,md:3},"& > *":{flexGrow:1,flexBasis:"50%"}},content:!1,...l,children:e.jsx(x,{sx:{p:{xs:2,sm:3,xl:2}},children:o})});T.propTypes={children:q.node};const le=({...o})=>{const l=W(),B=G(s=>s.customization),j=N();R();const[u,P]=w.useState(!1),[g,f]=w.useState(!1),z=()=>P(!u),E=s=>s.preventDefault(),D=async(s,{setErrors:a,setStatus:r,setSubmitting:d})=>{try{f(!0);const n=C.auth+C.login,m={email:s.email,password:s.password};fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}).then(i=>i.json()).then(i=>{if(i.success){const{access_token:p}=i.data;if(typeof p!="string")throw new Error("Invalid token format");const c=Z(p),F={id:c.sub,name:c.name,email:c.email,roles:c.roles,permissions:c.roles.flatMap(_=>_.permissions)},M=new Date().getTime(),L=i.data.expires_in*1e3+M;k.setItem("token",p),k.setItem("tokenExpiration",L),j(ee({type:se,user:F})),j({type:te,signed:!0}),window.location.href="/"}else r({success:!1}),a({submit:i.data.message}),d(!1)}).catch(i=>{r({success:!1}),a({submit:i.message}),d(!1)}).finally(()=>{f(!1)})}catch(n){r({success:!1}),a({submit:n.message}),d(!1)}};return e.jsx($,{initialValues:{email:"",password:"",submit:null},validationSchema:J().shape({email:b().email("Must be a valid email").max(255).required("Email is required"),password:b().max(255).required("Password is required")}),onSubmit:D,children:({errors:s,handleBlur:a,handleChange:r,handleSubmit:d,touched:n,values:m})=>e.jsxs("form",{noValidate:!0,onSubmit:d,...o,children:[e.jsx(t,{container:!0,direction:"column",justifyContent:"center",spacing:2,children:e.jsx(t,{item:!0,xs:12,container:!0,alignItems:"center",justifyContent:"center",children:e.jsx(x,{sx:{mb:3}})})}),e.jsxs(y,{style:{display:"flex"},error:!!(n.email&&s.email),children:[e.jsx(S,{htmlFor:"outlined-adornment-email-login",style:{fontSize:"12px"},children:"Email Address"}),e.jsx(I,{id:"outlined-adornment-email-login",type:"email",value:m.email,sx:{marginBottom:"16px"},name:"email",onBlur:a,onChange:r,label:"Email Address",inputProps:{}}),n.email&&s.email&&e.jsx(h,{error:!0,id:"standard-weight-helper-text-email-login",children:s.email})]}),e.jsxs(y,{style:{display:"flex",marginTop:2},error:!!(n.password&&s.password),children:[e.jsx(S,{htmlFor:"outlined-adornment-password-login",style:{fontSize:"12px"},children:"Password"}),e.jsx(I,{id:"outlined-adornment-password-login",type:u?"text":"password",value:m.password,name:"password",sx:{marginBottom:"16px"},onBlur:a,onChange:r,endAdornment:e.jsx(O,{position:"end",children:e.jsx(U,{"aria-label":"toggle password visibility",onClick:z,onMouseDown:E,edge:"end",size:"large",children:u?e.jsx(V,{fontSize:"small"}):e.jsx(K,{fontSize:"small"})})}),label:"Password",color:"primary"}),n.password&&s.password&&e.jsx(h,{error:!0,id:"standard-weight-helper-text-password-login",children:s.password})]}),e.jsx(A,{direction:"row",alignItems:"center",justifyContent:"flex-end",spacing:1,children:e.jsx(Q,{to:"/forgot-password",variant:"subtitle1",sx:{textDecoration:"none",cursor:"pointer"},children:"Forgot Password?"})}),s.submit&&e.jsx(x,{sx:{mt:3},children:e.jsx(h,{error:!0,children:s.submit})}),e.jsx(x,{sx:{mt:4},children:e.jsx(Y,{children:e.jsx(X,{disableElevation:!0,disabled:g,fullWidth:!0,size:"large",type:"submit",variant:"contained",sx:{padding:1.6,transition:"all .2s ease-in-out",'&[aria-controls="menu-list-grow"],&:hover':{background:l.palette.primary.dark},borderRadius:`${B.borderRadius}px`},children:g?e.jsx(re,{size:18}):"Sign in"})})})]})})},pe=()=>{const o=ne(l=>l.breakpoints.down("md"));return e.jsx(ie,{children:e.jsxs(t,{container:!0,direction:"column",justifyContent:"flex-end",sx:{minHeight:"100vh"},children:[e.jsx(t,{item:!0,xs:12,children:e.jsx(t,{container:!0,justifyContent:"center",alignItems:"center",sx:{minHeight:"calc(100vh - 68px)"},children:e.jsx(t,{item:!0,sx:{m:{xs:1,sm:3},mb:0},children:e.jsx(T,{children:e.jsxs(t,{container:!0,spacing:2,alignItems:"center",justifyContent:"center",children:[e.jsx(t,{item:!0,children:e.jsx(ae,{})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(t,{container:!0,direction:{xs:"column-reverse",md:"row"},alignItems:"center",justifyContent:"center",children:e.jsx(t,{item:!0,children:e.jsxs(A,{alignItems:"center",justifyContent:"center",spacing:1,children:[e.jsx(v,{color:"primary.main",gutterBottom:!0,variant:o?"h3":"h2",children:"Hi, Welcome"}),e.jsx(v,{variant:"caption",fontSize:"16px",textAlign:{xs:"center",md:"inherit"},children:"Enter your credentials to continue"})]})})})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(le,{})})]})})})})}),e.jsx(t,{item:!0,xs:12,sx:{m:3,mt:1},children:e.jsx(oe,{})})]})})};export{pe as default};
