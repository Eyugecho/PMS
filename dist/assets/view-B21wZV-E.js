import{c as P,q as ie,j as e,r,I as E,k as pe,P as o,T as d,t as he,v as ge,i as re,R as xe,B as i,d as ue,m as fe,w as me,D as je,C as L,G as T,x as oe,h as se,n as S,o as f,y as ye,Q as ve}from"./index-CsFgNO3o.js";import{P as be}from"./MainPage-CJwvk7F6.js";import{f as Ce}from"./index-DK6LBEOt.js";import{D as j,I as ke,a as Ie,b as Me}from"./DetailInfo-7dGIiuJp.js";import{P as Se}from"./PlanTable-BV9zDlg8.js";import{B as O}from"./Box-BBcNUpSQ.js";import{D as ze,a as De,b as Te,c as Pe}from"./DialogTitle-D1Q0RY_x.js";import{I as te}from"./IconDotsVertical-iUbTma2w.js";import{M as X}from"./MenuItem-BvD3M8VG.js";import{I as we}from"./IconTrash-D_o8MoK5.js";import{I as Re}from"./IconTargetArrow-CNY_8Ufo.js";import"./TableContainer-qijX9D2r.js";import"./TableRow-CVrgL676.js";import"./TableCell-F9dx6MLR.js";import"./KeyboardArrowUp-eGxCS8hM.js";var Ae=P("building","IconBuilding",[["path",{d:"M3 21l18 0",key:"svg-0"}],["path",{d:"M9 8l1 0",key:"svg-1"}],["path",{d:"M9 12l1 0",key:"svg-2"}],["path",{d:"M9 16l1 0",key:"svg-3"}],["path",{d:"M14 8l1 0",key:"svg-4"}],["path",{d:"M14 12l1 0",key:"svg-5"}],["path",{d:"M14 16l1 0",key:"svg-6"}],["path",{d:"M5 21v-16a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v16",key:"svg-7"}]]),Be=P("chair-director","IconChairDirector",[["path",{d:"M6 21l12 -9",key:"svg-0"}],["path",{d:"M6 12l12 9",key:"svg-1"}],["path",{d:"M5 12h14",key:"svg-2"}],["path",{d:"M6 3v9",key:"svg-3"}],["path",{d:"M18 3v9",key:"svg-4"}],["path",{d:"M6 8h12",key:"svg-5"}],["path",{d:"M6 5h12",key:"svg-6"}]]),Le=P("direction","IconDirection",[["path",{d:"M9 10l3 -3l3 3",key:"svg-0"}],["path",{d:"M9 14l3 3l3 -3",key:"svg-1"}]]),Ee=P("edit","IconEdit",[["path",{d:"M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1",key:"svg-0"}],["path",{d:"M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z",key:"svg-1"}],["path",{d:"M16 5l3 3",key:"svg-2"}]]),Ue=P("replace","IconReplace",[["path",{d:"M3 3m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M15 15m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-1"}],["path",{d:"M21 11v-3a2 2 0 0 0 -2 -2h-6l3 3m0 -6l-3 3",key:"svg-2"}],["path",{d:"M3 13v3a2 2 0 0 0 2 2h6l-3 -3m0 6l3 -3",key:"svg-3"}]]);const _e=ie(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle"),Ge=ie(e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person");function Oe({icon:n,children:s}){const[p,l]=r.useState(null),x=m=>{l(m.currentTarget)},z=()=>{l(null)},v=!!p,u=v?"popover":void 0;return e.jsxs("div",{children:[e.jsx(E,{"aria-describedby":u,onClick:x,children:n}),e.jsx(pe,{id:u,open:v,anchorEl:p,onClose:z,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:s})]})}const le=({content:n,onTitleClick:s,label:p,children:l,sx:x})=>e.jsxs(O,{sx:{display:"flex",flexDirection:"row",alignItems:"center",marginY:1.2,...x},children:[e.jsx(O,{children:l}),e.jsxs(O,{sx:{marginLeft:2},children:[e.jsx(d,{variant:"subtitle1",sx:{maxWidth:"400px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:s,children:n}),e.jsx(d,{variant:"subtitle2",children:p})]})]});le.propTypes={content:o.any,onTitleClick:o.func,label:o.any,children:o.node,sx:o.object};var Y={},Xe=ge;Object.defineProperty(Y,"__esModule",{value:!0});var ce=Y.default=void 0,Ye=Xe(he()),qe=e;ce=Y.default=(0,Ye.default)((0,qe.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search");const de=({open:n,handleDialogClose:s,unit_id:p,managers:l,isLoading:x,searchText:z,searching:v,onTextChange:u,onSubmit:m})=>{const[c,w]=r.useState(null),[b,C]=r.useState(!1),h=re(),R=a=>{a.key==="Enter"&&(a.preventDefault(),m())},U=a=>{c&&c.id==a.id?w(null):w(a)},_=()=>{C(!0);var a=f.api+f.units+"/"+p;const k={Authorization:"Bearer"+localStorage.getItem("token"),accept:"application/json","Content-Type":"application/json"},G={manager_id:c.id,unit_id:p};fetch(a,{method:"PATCH",headers:k,body:JSON.stringify(G)}).then(g=>g.json()).then(g=>{g.success?(C(!1),s(),S.success(g.data.message)):(C(!1),S.error(g.data.message))}).catch(g=>{C(!1),S.error(g.message)})};return e.jsx(xe.Fragment,{children:e.jsxs(ze,{open:n,onClose:s,children:[e.jsxs(i,{sx:{position:"sticky",top:0,zIndex:2,width:"100%",backgroundColor:h.palette.primary.main,display:"flex",alignItems:"center",justifyContent:"space-between",paddingRight:2,paddingY:.6},children:[e.jsx(De,{variant:"h4",color:h.palette.background.default,children:"Assign Manager"}),e.jsx(E,{onClick:s,children:e.jsx(ue,{size:20,color:h.palette.background.default})})]}),e.jsxs(Te,{sx:{width:500,padding:4},children:[e.jsxs(fe,{component:"form",sx:{border:.6,display:"flex",alignItems:"center"},children:[e.jsx(me,{sx:{ml:1,px:1.5,flex:1},placeholder:"Search",inputProps:{"aria-label":"search"},value:z,onChange:u,onKeyDown:R}),e.jsx(je,{sx:{height:28,m:.5},orientation:"vertical"}),e.jsx(E,{type:"button",sx:{p:"8px"},"aria-label":"search",onClick:m,children:v?e.jsx(L,{size:20}):e.jsx(ce,{})})]}),e.jsx(T,{container:!0,children:e.jsx(T,{item:!0,xs:12,children:x?e.jsx(i,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",padding:4},children:e.jsx(L,{size:20})}):e.jsx(i,{sx:{paddingTop:2},children:l.length==0?e.jsxs(i,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:4},children:[e.jsx(oe,{}),e.jsx(d,{variant:"body2",children:"Manager is not found"})]}):l.map(a=>{var D,k;return e.jsxs(i,{onClick:()=>U(a),sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginY:1,padding:1.2,border:1,borderColor:h.palette.primary[200],borderRadius:2,backgroundColor:c&&c.id===a.id&&h.palette.primary[200],cursor:"pointer"},children:[e.jsx(i,{children:e.jsx(le,{content:(D=a==null?void 0:a.user)==null?void 0:D.name,label:(k=a==null?void 0:a.user)==null?void 0:k.email,sx:{paddinY:3},children:e.jsx(Ge,{fontSize:"small"})})}),e.jsx(i,{children:c&&c.id===a.id&&e.jsx(_e,{color:"primary",fontSize:"small"})})]},a.id)})})})})]}),e.jsxs(Pe,{sx:{padding:2},children:[e.jsx(se,{onClick:s,children:"Cancel"}),e.jsx(se,{onClick:()=>_(),variant:"outlined",sx:{paddingX:6},disabled:!c,children:b?e.jsx(L,{size:16}):"Assign"})]})]})})};de.propTypes={open:o.bool,handleDialogClose:o.func,managers:o.array,isLoading:o.bool,searchText:o.string,onTextChange:o.func,onSubmit:o.func,searching:o.bool};const y="black",rn=()=>{var q,K,F,$,V,H,J,N,Q,W,Z,ee,ne,ae;const{state:n}=ye(),s=re(),[p,l]=r.useState(!0),[x,z]=r.useState([]),[v,u]=r.useState(!1);r.useState({pageSize:20,page:1});const[m,c]=r.useState([]),[w,b]=r.useState(!1),[C,h]=r.useState(!1),[R,U]=r.useState(""),[_,a]=r.useState(!1),D=()=>{h(!0),G()},k=()=>{h(!1)},G=()=>{if(h(!0),m.length==0){b(!0);var I=f.api+f.getManagers,A={Authorization:"Bearer"+localStorage.getItem("token"),accept:"application/json","Content-Type":"application/json"};fetch(I,{method:"GET",headers:A}).then(t=>t.json()).then(t=>{t.success?(b(!1),c(t.data)):(b(!1),S.error(t.data.message))}).catch(t=>{b(!1),S.error(t.message)})}},g=()=>{a(!0);var I=f.api+f.getManagers+`?search=${R}`,B={Authorization:"Bearer"+localStorage.getItem("token"),accept:"application/json","Content-Type":"application/json"};fetch(I,{method:"GET",headers:B}).then(t=>t.json()).then(t=>{t.success?(a(!1),c(t.data)):(a(!1),handlePrompts(t.message,"error"))}).catch(t=>{a(!1),handlePrompts(t,"error")})};return r.useEffect(()=>((()=>{const A=localStorage.getItem("token"),B=f.api+f.getUnitTarget+(n==null?void 0:n.id),t={Authorization:`Bearer ${A}`,accept:"application/json","Content-Type":"application/json"};fetch(B,{method:"GET",headers:t}).then(M=>M.json()).then(M=>{M.success?(z(M.data),l(!1),u(!1)):(l(!1),u(!1))}).catch(M=>{S(M.message),u(!0),l(!1)})})(),()=>{}),[n==null?void 0:n.id]),e.jsxs(be,{back:!0,title:"Unit Details",children:[e.jsxs(T,{container:!0,sx:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",padding:2},children:[e.jsxs(T,{item:!0,xs:12,sm:12,md:3.8,lg:3.2,xl:3.2,sx:{backgroundColor:s.palette.primary[200],border:.4,borderColor:s.palette.grey[200],borderRadius:2},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:1,paddingLeft:2,borderBottom:.4,borderColor:s.palette.grey[500]},children:[e.jsx(d,{variant:"h4",children:"Unit Info"}),e.jsx(Oe,{icon:e.jsx(te,{size:18}),children:e.jsxs(i,{sx:{paddingY:1.6,paddingX:1},children:[e.jsxs(X,{sx:{borderRadius:2,padding:1,paddingX:2},onClick:()=>D(),children:[e.jsx(Ue,{size:20,style:{paddingRight:2}})," ",e.jsx(d,{variant:"body2",marginLeft:1,children:n!=null&&n.manager?"Change manager":"Assign Manager"})]}),e.jsxs(X,{sx:{borderRadius:2,padding:1,paddingX:2},children:[e.jsx(Ee,{size:20,style:{paddingRight:2}})," ",e.jsx(d,{variant:"body2",marginLeft:1,children:"Edit"})]}),e.jsxs(X,{sx:{borderRadius:2,padding:1,paddingX:2},children:[e.jsx(we,{size:20,style:{paddingRight:2,color:s.palette.error.main}}),e.jsx(d,{variant:"body2",color:s.palette.error.main,marginLeft:1,children:"Delete"})]})]})})]}),e.jsxs(i,{sx:{padding:2},children:[(n==null?void 0:n.name)&&e.jsx(j,{label:"Unit name",info:n==null?void 0:n.name,icon:e.jsx(Ae,{size:24,color:y})}),((q=n==null?void 0:n.unit_type)==null?void 0:q.name)&&e.jsx(j,{label:"Unit type",info:(K=n==null?void 0:n.unit_type)==null?void 0:K.name,icon:e.jsx(Le,{size:24,color:y})}),(($=(F=n==null?void 0:n.manager)==null?void 0:F.user)==null?void 0:$.name)&&e.jsx(j,{label:"Manager name",info:(H=(V=n==null?void 0:n.manager)==null?void 0:V.user)==null?void 0:H.name,icon:e.jsx(oe,{size:24,color:y})}),((J=n==null?void 0:n.manager)==null?void 0:J.position)&&e.jsx(j,{label:"Manager Position",info:(N=n==null?void 0:n.manager)==null?void 0:N.position,icon:e.jsx(Be,{size:24,color:y})}),((W=(Q=n==null?void 0:n.manager)==null?void 0:Q.user)==null?void 0:W.email)&&e.jsx(j,{label:"Manager email",info:(ee=(Z=n==null?void 0:n.manager)==null?void 0:Z.user)==null?void 0:ee.email,icon:e.jsx(ke,{size:24,color:y})}),(n==null?void 0:n.position)&&e.jsx(j,{label:"Position",info:n==null?void 0:n.position,icon:e.jsx(Ie,{size:24,color:y})}),((ne=n==null?void 0:n.user)==null?void 0:ne.created_at)&&e.jsx(j,{label:"Start date",info:Ce((ae=n==null?void 0:n.user)==null?void 0:ae.created_at).formattedDate,icon:e.jsx(Me,{size:24,color:y})})]})]}),e.jsxs(T,{item:!0,xs:12,sm:12,md:7.9,lg:8.6,xl:8.6,sx:{backgroundColor:s.palette.background.default,border:.4,borderColor:s.palette.grey[200],borderRadius:2},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:1,paddingLeft:2,borderBottom:.4,borderColor:s.palette.grey[200]},children:[e.jsx(d,{variant:"h4",children:"Unit KPI's and Targets"}),e.jsx(E,{children:e.jsx(te,{size:18})})]}),e.jsx(i,{children:p?e.jsx(i,{sx:{padding:4,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(L,{size:20})}):v?e.jsx(i,{sx:{padding:4,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(d,{variant:"body2",children:"There is error fetching the unit KPI's"})}):x.length===0?e.jsxs(i,{sx:{padding:4,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx(Re,{size:80,color:s.palette.grey[400]}),e.jsx(d,{variant:"h4",sx:{marginTop:1.6},children:"Unit target is not found"}),e.jsx(d,{variant:"caption",children:"The list of assigned target will be listed here"})]}):e.jsx(Se,{plans:x,page:"unit"})})]})]}),e.jsx(de,{open:C,handleDialogClose:()=>k(),managers:m,unit_id:n.id,isLoading:w,searchText:R,searching:_,onTextChange:I=>U(I.target.value),onSubmit:()=>g()}),e.jsx(ve,{})]})};export{rn as default};
