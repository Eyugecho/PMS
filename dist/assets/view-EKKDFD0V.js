import{o as M,ay as le,Y as ce,a3 as de,r as d,j as e,a9 as pe,a0 as f,a1 as q,a4 as v,a8 as r,p as l,ag as he,ax as ge,W as me,J as xe,a5 as k,a6 as g,a2 as p,a7 as fe}from"./index-BrIZ1aRM.js";import{D as y,I as ue,a as je,b as ye}from"./DetailInfo-CgzLft0Q.js";import{f as Q}from"./index-C_-DKd_R.js";import{P as ve}from"./PlanTable-DrO-TxHX.js";import{A as D}from"./ActivityIndicator-BsI2VQVz.js";import{F as be}from"./index-CJagu-9E.js";import{P as ke}from"./PerformanceCard-B4CFarf5.js";import{P as Ce}from"./PerKPI-2YUukMzH.js";import{D as Te}from"./DrogaButton-DGfkej71.js";import{I as Ie,S as Pe,a as we}from"./CreateTask-Bcy880fo.js";import{I as Ee}from"./IconTargetArrow-1oWt4WOx.js";import{I as ze}from"./IconPlus-CfO6zmqS.js";import{T as Se}from"./TablePagination-Cpy0D8zw.js";import"./DialogTitle-CTwNxPSd.js";import"./TableContainer-CbJxeCPv.js";import"./TableRow-BXiBQlkf.js";import"./TableCell-BqWHfhA4.js";import"./KeyboardArrowUp-CKJz877C.js";import"./error-DW4k7GIP.js";import"./DrogaDonutChart-BcPDFQqh.js";import"./DrogaFormModal-lipSAK58.js";import"./Box-DiQAjjjZ.js";import"./KeyboardArrowRight-pfrJvB3H.js";import"./LastPage-C9NjV3u0.js";var De=M("gender-male","IconGenderMale",[["path",{d:"M10 14m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0",key:"svg-0"}],["path",{d:"M19 5l-5.4 5.4",key:"svg-1"}],["path",{d:"M19 5h-5",key:"svg-2"}],["path",{d:"M19 5v5",key:"svg-3"}]]),Me=M("phone","IconPhone",[["path",{d:"M5 4h4l2 5l-2.5 1.5a11 11 0 0 0 5 5l1.5 -2.5l5 2v4a2 2 0 0 1 -2 2a16 16 0 0 1 -15 -15a2 2 0 0 1 2 -2",key:"svg-0"}]]),Ae=M("tie","IconTie",[["path",{d:"M12 22l4 -4l-2.5 -11l.993 -2.649a1 1 0 0 0 -.936 -1.351h-3.114a1 1 0 0 0 -.936 1.351l.993 2.649l-2.5 11l4 4z",key:"svg-0"}],["path",{d:"M10.5 7h3l5 5.5",key:"svg-1"}]]);const Be=[{label:"Pending",value:"pending"},{label:"In-progrees",value:"inprogress"},{label:"Done",value:"done"},{label:"Blocked",value:"blocked"},{label:"Cancelled",value:"cancelled"}],ia=()=>{var $,F,L,G,R,O,N,W,K,J;const{state:a}=le(),m=ce(),u=de(t=>t.customization.selectedFiscalYear),[U,C]=d.useState(!1),[T,V]=d.useState([]),[Z,I]=d.useState(!1),[A,B]=d.useState(!1),[b,P]=d.useState([]),[H,_]=d.useState(!1),[X,Y]=d.useState(null),[j,x]=d.useState({loading:!0,taskList:[],openModal:!1,submitting:!1,date:"",picker:!1,changing:!1}),[c,w]=d.useState({page:0,per_page:10,total:0}),ee=t=>{const o=t.target.value;x(i=>({...i,date:o}))},ae=()=>{x(t=>({...t,picker:!0}))},te=(t,o)=>{w({...c,page:o})},ne=t=>{w({...c,per_page:t.target.value}),setPage(0)},se=async(t,o)=>{const i=t.target.value;x(h=>({...h,changing:!0}));const s=await k(),n=g.api+g.employeeTaskStatus+o.id,z={Authorization:`Bearer ${s}`,accept:"application/json","Content-Type":"application/json"};fetch(n,{method:"POST",headers:z,body:JSON.stringify({status:i})}).then(h=>h.json()).then(h=>{h.success?E():p.error(h.message)}).catch(h=>{p.error(h.message)}).finally(()=>{x(h=>({...h,changing:!1}))})},ie=()=>{x(t=>({...t,openModal:!0}))},oe=()=>{x(t=>({...t,openModal:!1}))},re=async t=>{Y(t),_(!0);const o=await k(),i=g.api+g.employeeTasks+"/"+t,s={Authorization:"Bearer"+o,accept:"application/json","Content-Type":"application/json"};fetch(i,{method:"DELETE",headers:s}).then(n=>n.json()).then(n=>{n.success?(p.success(n.data.message),E()):p.error(n.data.message)}).catch(n=>{p.error(n.message)}).finally(()=>{_(!1)})},E=async()=>{x(s=>({...s,loading:!0}));const t=await k(),o=g.api+g.getEmployeeTask+(a==null?void 0:a.id)+`?date=${j.date}&fiscal_year_id=${u==null?void 0:u.id}&page=${c.page}&per_page=${c.per_page}`,i={Authorization:`Bearer ${t}`,accept:"application/json","Content-Type":"application/json"};fetch(o,{method:"GET",headers:i}).then(s=>s.json()).then(s=>{s.success?(x(n=>({...n,taskList:s.data.data})),w({...c,total:s.data.total}),oe()):p.warning(s.message)}).catch(s=>{p.warning(s.message)}).finally(()=>{x(s=>({...s,loading:!1}))})};return d.useEffect(()=>{E()},[j.date,c.page,c.per_page]),d.useEffect(()=>{(async()=>{if(u){B(!0);const o=await k(),i=g.api+g.employeePerformance+`${a==null?void 0:a.id}?fiscal_year_id=${u==null?void 0:u.id}`,s={Authorization:`Bearer ${o}`,accept:"application/json","Content-Type":"application/json"};fetch(i,{method:"GET",headers:s}).then(n=>n.json()).then(n=>{n.success?P(n.data.performance):(P([]),p.warning(n.data.message))}).catch(n=>{P([]),p.warning(n.message)}).finally(()=>{B(!1)})}else return e.jsx(fe,{})})()},[u]),d.useEffect(()=>((async()=>{C(!0);const o=await k(),i=g.api+g.getEmployeeTarget+(a==null?void 0:a.id),s={Authorization:`Bearer ${o}`,accept:"application/json","Content-Type":"application/json"};fetch(i,{method:"GET",headers:s}).then(n=>n.json()).then(n=>{n.success?(V(n.data),C(!1),I(!1)):(C(!1),I(!1),p.warning(n.data.message))}).catch(n=>{p.warning(n.message),I(!0),C(!1)})})(),()=>{}),[a==null?void 0:a.id]),e.jsxs(pe,{back:!0,title:"Employee Details",children:[e.jsx(f,{container:!0,sx:{display:"flex",justifyContent:"space-between",padding:2},spacing:q,children:e.jsx(f,{item:!0,xs:12,children:e.jsxs(v,{children:[e.jsx(r,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:1,paddingLeft:2,borderBottom:.4,borderColor:m.palette.divider},children:e.jsx(l,{variant:"h4",children:"Employee KPI's and Targets"})}),e.jsx(r,{children:U?e.jsx(r,{sx:{padding:4,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(he,{size:20})}):Z?e.jsx(r,{sx:{padding:4,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(l,{variant:"body2",children:"There is error fetching the Employees"})}):T.length===0?e.jsxs(r,{sx:{padding:4,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx(Ee,{size:80,color:m.palette.grey[400]}),e.jsx(l,{variant:"h4",sx:{marginTop:1.6},children:"Employee target is not found"}),e.jsx(l,{variant:"caption",children:"The list of assigned target will be listed here"})]}):e.jsx(ve,{plans:T,page:"employee"})})]})})}),e.jsxs(f,{container:!0,sx:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",padding:2},spacing:q,children:[e.jsxs(f,{item:!0,xs:12,sm:12,md:6,lg:6,xl:6,children:[e.jsxs(v,{children:[e.jsx(r,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:.4,borderColor:m.palette.divider,paddingBottom:1.8},children:e.jsx(l,{variant:"h4",children:"Employee Details"})}),e.jsxs(r,{children:[(a==null?void 0:a.user)&&e.jsx(y,{label:"Full name",info:($=a==null?void 0:a.user)==null?void 0:$.name,icon:e.jsx(ge,{size:22})}),(a==null?void 0:a.gender)&&e.jsx(y,{label:"Gender",info:a==null?void 0:a.gender,icon:e.jsx(De,{size:22})}),((F=a==null?void 0:a.user)==null?void 0:F.email)&&e.jsx(y,{label:"Email",info:(L=a==null?void 0:a.user)==null?void 0:L.email,icon:e.jsx(ue,{size:22})}),((G=a==null?void 0:a.user)==null?void 0:G.phone)&&e.jsx(y,{label:"Phone",info:(R=a==null?void 0:a.user)==null?void 0:R.phone,icon:e.jsx(Me,{size:22})}),((O=a==null?void 0:a.user)==null?void 0:O.role)&&e.jsx(y,{label:"Role",info:(N=a==null?void 0:a.user)==null?void 0:N.role,icon:e.jsx(Ae,{size:22})}),(a==null?void 0:a.position)&&e.jsx(y,{label:"Position",info:a==null?void 0:a.position,icon:e.jsx(je,{size:22})}),((W=a==null?void 0:a.user)==null?void 0:W.created_at)&&e.jsx(y,{label:"Start date",info:Q((K=a==null?void 0:a.user)==null?void 0:K.created_at).formattedDate,icon:e.jsx(ye,{size:22})})]})]}),e.jsxs(v,{sx:{mt:2},children:[e.jsx(l,{variant:"h4",children:"Overall Performance"}),e.jsx(f,{container:!0,children:e.jsx(f,{item:!0,xs:12,children:A?e.jsx(r,{sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:2},children:e.jsx(D,{size:20})}):b.length>0?e.jsx(f,{container:!0,sx:{marginTop:2,borderTop:.8,borderColor:m.palette.divider,padding:1},children:e.jsx(f,{item:!0,xs:12,sx:{display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"space-between"},children:b==null?void 0:b.map((t,o)=>{var S;const i=Object.keys(t)[0],[s,n]=i.match(/[a-zA-Z]+|[0-9]+/g),z=`${s} ${n}`;return e.jsx(ke,{isEvaluated:t[i].is_evaluated,performance:(S=t[i])==null?void 0:S.overall,frequency:z},o)})})}):e.jsx(be,{severity:"performance",title:"No employee performance report",description:"The employee performances will be listed here",sx:{paddingTop:2}})})})]}),e.jsxs(v,{sx:{mt:2},children:[e.jsx(l,{variant:"h4",children:"Per KPI performance"}),e.jsx(Ce,{isLoading:A,performance:b})]})]}),e.jsx(f,{item:!0,xs:12,sm:12,md:6,lg:6,xl:6,children:e.jsxs(v,{children:[e.jsxs(r,{sx:{display:"flex",alignItems:"flex-start",justifyContent:"space-between"},children:[e.jsxs(r,{children:[e.jsx(l,{variant:"h4",children:"Daily Activities"}),j.picker?e.jsx(me,{id:"date",name:"date",type:"date",sx:{"& .MuiOutlinedInput-root":{"& fieldset":{border:"none"}},ml:-2,p:0,mt:-1},value:j.date,onChange:ee}):e.jsx(l,{variant:"body1",mt:1,onClick:()=>ae(),sx:{cursor:"pointer",":hover":{fontWeight:m.typography.fontWeightMedium}},children:"Today"})]}),e.jsx(Te,{title:"Create Task",variant:"text",icon:e.jsx(ze,{size:"1.2rem",stroke:"1.2",style:{marginRight:4}}),sx:{boxShadow:0,backgroundColor:m.palette.grey[50]},onPress:ie,disabled:T.length===0})]}),j.loading?e.jsx(r,{sx:{padding:4,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(D,{size:20})}):j.taskList.length===0?e.jsxs(r,{sx:{padding:4,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx(Ie,{size:80,color:m.palette.grey[400]}),e.jsx(l,{variant:"h4",sx:{marginTop:1.6},children:"No task planned today"}),e.jsx(l,{variant:"caption",children:"The list of created task will be listed here"})]}):e.jsxs(r,{sx:{marginTop:3},children:[(J=j.taskList)==null?void 0:J.map((t,o)=>{var i,s;return e.jsxs(v,{sx:{backgroundColor:m.palette.grey[50],marginTop:1.6,display:"flex",alignItems:"center",justifyContent:"space-between",py:1},children:[e.jsxs(r,{children:[e.jsx(l,{variant:"body1",children:(s=(i=t.plan)==null?void 0:i.kpi)==null?void 0:s.name}),e.jsx(l,{variant:"h4",my:1,children:t.title}),e.jsx(l,{variant:"subtitle2",children:Q(t==null?void 0:t.date).formattedDate})]}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx(Pe,{name:"status",options:Be,selected:t.status,handleSelection:n=>se(n,t)}),H&&X===t.id?e.jsx(D,{size:16}):e.jsx(xe,{onClick:()=>re(t.id),title:"remove",children:e.jsx(we,{size:"1.2rem",stroke:"1.6",color:m.palette.error.main})})]})]},o)}),c.total>c.per_page&&e.jsx(Se,{component:"div",rowsPerPageOptions:[10,25,50,100],count:c.total,rowsPerPage:c.per_page,page:c.page,onPageChange:te,onRowsPerPageChange:ne,labelRowsPerPage:"Tasks per page"})]})]})})]})]})};export{ia as default};
